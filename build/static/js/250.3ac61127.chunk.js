"use strict";(self.webpackChunkproperty_manage_system_web=self.webpackChunkproperty_manage_system_web||[]).push([[250],{19246:function(e,a,t){t.d(a,{Wm:function(){return x},Jb:function(){return f},Ao:function(){return _},BX:function(){return C}});var n=t(72791),i=t(56994),r=t(42937),s=n.lazy((function(){return Promise.all([t.e(387),t.e(189)]).then(t.bind(t,28189))})),o=n.lazy((function(){return Promise.all([t.e(387),t.e(824)]).then(t.bind(t,21824))})),m=n.lazy((function(){return Promise.all([t.e(387),t.e(88)]).then(t.bind(t,99088))})),l=n.lazy((function(){return Promise.all([t.e(387),t.e(818)]).then(t.bind(t,45818))})),c=n.lazy((function(){return Promise.all([t.e(387),t.e(264)]).then(t.bind(t,12264))})),d=n.lazy((function(){return Promise.all([t.e(387),t.e(569),t.e(452)]).then(t.bind(t,9452))})),u=[{path:"/admin/",exact:!0,name:"Home"},{path:"/admin/users",exact:!0,name:"Users",component:s},{path:"/admin/users/new",exact:!0,name:"New User",component:m},{path:"/admin/users/:id",exact:!0,name:"User Details",component:o},{path:"/admin/edit/user/:id",exact:!0,name:"Edit User",component:m},{path:"/admin/file-upload",exact:!0,name:"FileUpload",component:n.lazy((function(){return Promise.all([t.e(569),t.e(342),t.e(243)]).then(t.bind(t,86243))}))},{path:"/admin/properties",exact:!0,name:"Properties",component:l},{path:"/admin/properties/new",exact:!0,name:"New Property",component:d},{path:"/admin/properties/:id",exact:!0,name:"Property Details",component:c},{path:"/admin/edit/property/:id",exact:!0,name:"Edit Property",component:d},{path:"/admin/properties/:id",exact:!0,name:"User Details",component:o}],p=t(80184),h=(r.Z,function(){return(0,p.jsx)(i.pG,{fixed:!1})}),x=n.memo(h),b=t(60364),j=t(15301),f=function(){var e=(0,b.useDispatch)(),a=(0,b.useSelector)((function(e){return e.admin.sidebarShow}));return(0,p.jsxs)(i.PO,{withSubheader:!0,children:[(0,p.jsx)(i.FP,{inHeader:!0,className:"ml-md-3 d-lg-none",onClick:function(){var t=!![!1,"responsive"].includes(a)||"responsive";e((0,j.YB)(t))}}),(0,p.jsx)(i.FP,{inHeader:!0,className:"ml-3 d-md-down-none",onClick:function(){var t=![!0,"responsive"].includes(a)&&"responsive";e((0,j.YB)(t))}}),(0,p.jsx)(i.qy,{className:"mx-auto d-lg-none",to:"/"}),(0,p.jsx)(i.g3,{className:"d-md-down-none mr-auto"}),(0,p.jsx)(i.g3,{className:"px-3",children:(0,p.jsx)(_,{})}),(0,p.jsx)(i.Mj,{className:"px-3 justify-content-between",children:(0,p.jsx)(i.s_,{className:"border-0 c-subheader-nav m-0 px-0 px-md-3",routes:u})})]})},g=t(16516),v=t(91523),_=function(){return(0,p.jsxs)(i.w5,{inNav:!0,className:"c-header-nav-items mx-2",direction:"down",children:[(0,p.jsx)(i.SQ,{className:"c-header-nav-link",caret:!1,children:(0,p.jsx)("div",{className:"c-avatar",children:(0,p.jsx)(i.sE,{src:"/assets/img/default-user.png",className:"c-avatar-img",style:{backgroundColor:"black"}})})}),(0,p.jsx)(i.$H,{className:"pt-0",placement:"bottom-end",children:(0,p.jsxs)(i.$f,{tag:v.rU,to:"/logout",children:[(0,p.jsx)(g.ZP,{name:"cil-lock-locked",className:"mfe-2"}),"Logout"]})})]})},N=function(){var e=(0,b.useDispatch)(),a=(0,b.useSelector)((function(e){return e.admin.sidebarShow}));return(0,p.jsxs)(i.z3,{show:a,onShowChange:function(a){return e((0,j.YB)(a))},children:[(0,p.jsxs)(i.Dl,{className:"d-md-down-none",to:"/",children:[(0,p.jsx)(i.sE,{className:"c-sidebar-brand-full",src:"/assets/img/logo-sm.png",height:35}),(0,p.jsx)(i.sE,{className:"c-sidebar-brand-minimized",src:"/assets/img/icon-white-small.png",height:35})]}),(0,p.jsx)(i.Xk,{children:(0,p.jsx)(i.gP,{items:[{_tag:"CSidebarNavTitle",_children:["Data"]},{_tag:"CSidebarNavItem",name:"Users",to:"/admin/users",icon:"cil-user"},{_tag:"CSidebarNavItem",name:"Properties",to:"/admin/properties",icon:"cil-home"},{_tag:"CSidebarNavTitle",_children:["Campaigns"]},{_tag:"CSidebarNavItem",name:"Email Campaigns",to:"/admin/email-campaigns",icon:"cil-home"},{_tag:"CSidebarNavItem",name:"Templates",to:"/admin/templates",icon:"cil-home"},{_tag:"CSidebarNavTitle",_children:["Marketing"]},{_tag:"CSidebarNavItem",name:"Coupons",to:"/admin/coupons",icon:"cil-user"},{_tag:"CSidebarNavItem",name:"Flyer",to:"/admin/flyers",icon:"cil-user"},{_tag:"CSidebarNavItem",name:"Promting Events",to:"/admin/events",icon:"cil-user"}],components:{CSidebarNavDivider:i.IE,CSidebarNavDropdown:i.Uu,CSidebarNavItem:i.g$,CSidebarNavTitle:i.Ig}})}),(0,p.jsx)(i.p_,{className:"c-d-md-down-none"})]})},C=n.memo(N)},47250:function(e,a,t){t.r(a);var n=t(74165),i=t(15861),r=t(1413),s=t(29439),o=t(56994),m=t(70456),l=t(72791),c=t(60364),d=t(64880),u=t(64064),p=t(15301),h=t(66023),x=t(51802),b=(t(25646),t(199)),j=t.n(b),f=t(72010),g=t(19246),v=(t(83309),t(80184)),_=u.Ry().shape({from_name:u.Z_().required("From name is required"),template_name:u.Z_().required("Template name is required"),subject:u.Z_().required("Subject is required")});a.default=function(e){var a=e.match,t=(0,c.useDispatch)(),u=(0,d.k6)(),b=((0,c.useSelector)((function(e){return e.admin.roles})),(0,c.useSelector)((function(e){return e.auth.me}))),N=(0,l.useState)(f.EditorState.createEmpty()),C=(0,s.Z)(N,2),y=C[0],S=C[1],w=(0,m.TA)({initialValues:{id:a.params.id,from_name:"",template_name:"",subject:"",from_email:"",template_body:""},validationSchema:_,onSubmit:function(e,n){var i=n.setSubmitting;i(!0);var s=(0,r.Z)((0,r.Z)({},e),{},{owner_id:b.id,tenant:b.id});t((0,p.Xu)(s)).then((function(e){console.log("..save template..",e),a.params.id?u.push("/admin/templates/".concat(a.params.id)):u.push("/admin/templates")})).catch((function(){return i(!1)}))}}),k=w.handleChange,P=w.handleBlur,E=w.handleSubmit,F=w.errors,Z=w.touched,z=w.values,B=w.isValid,D=w.isSubmitting,T=w.resetForm,I=w.setValues,U=(w.setFieldValue,w.setFieldTouched,(0,l.useState)(!0)),q=(0,s.Z)(U,2);q[0],q[1];(0,l.useEffect)((function(){a.params.id&&t((0,p.Dv)(a.params.id)).then((function(e){var a=e.value;console.log("...fetch template..",a),I({id:a.data.id,template_name:a.data.attributes.template_name,subject:a.data.attributes.subject,from_email:a.data.attributes.from_email,from_name:a.data.attributes.from_name,template_body:a.data.attributes.template_body}),S(f.EditorState.createWithContent(f.ContentState.createFromBlockArray((0,f.convertFromHTML)(a.data.attributes.template_body))))}))}),[t,b,a.params.id,I]);var W=(0,l.useState)([]),$=(0,s.Z)(W,2),A=($[0],$[1],function(){var e=(0,i.Z)((0,n.Z)().mark((function e(a){var t,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new FormData).append("files",a),e.next=4,http.post(apiUrl+"/upload",t,{headers:{Authorization:"Bearer ".concat(token)}});case 4:return i=e.sent,console.log("..imgData.."+JSON.stringify(i)),e.abrupt("return",Promise.resolve({data:{link:"https://rest.klosertoyou.com".concat(i.data[0].url)}}));case 7:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}());return(0,v.jsxs)("div",{className:"c-app c-default-layout",children:[(0,v.jsx)(g.BX,{}),(0,v.jsxs)("div",{className:"c-wrapper",children:[(0,v.jsx)(g.Jb,{}),(0,v.jsx)("div",{className:"c-body",children:(0,v.jsx)("main",{className:"c-main",children:(0,v.jsx)(o.KB,{fluid:!0,className:"h-100",children:(0,v.jsxs)("div",{className:"content",children:[(0,v.jsx)(o.rb,{children:(0,v.jsx)(o.b7,{md:12,children:(0,v.jsx)(o.lx,{onSubmit:E,children:(0,v.jsxs)(o.xH,{children:[(0,v.jsxs)(o.bn,{children:["Template id: ",a.params.id]}),(0,v.jsxs)(o.sl,{children:[(0,v.jsx)(o.b7,{xs:"12",children:(0,v.jsxs)(o.We,{children:[(0,v.jsx)(o.cc,{htmlFor:"template_name",children:"Template Name"}),(0,v.jsx)(o.C$,{id:"template_name",name:"template_name",onChange:k,onBlur:P,value:z.template_name,invalid:Z.template_name&&F.template_name}),(0,v.jsx)(o.ev,{children:F.template_name})]})}),(0,v.jsx)(o.b7,{xs:"12",children:(0,v.jsxs)(o.We,{children:[(0,v.jsx)(o.cc,{htmlFor:"subject",children:"Subject"}),(0,v.jsx)(o.C$,{id:"subject",name:"subject",onChange:k,onBlur:P,value:z.subject,invalid:Z.subject&&F.subject}),(0,v.jsx)(o.ev,{children:F.subject})]})}),(0,v.jsx)(o.b7,{xs:"12",children:(0,v.jsxs)(o.We,{children:[(0,v.jsx)(o.cc,{htmlFor:"from_email",children:"From Email"}),(0,v.jsx)(o.C$,{id:"from_email",name:"from_email",onChange:k,onBlur:P,value:z.from_email,invalid:Z.from_email&&F.from_email}),(0,v.jsx)(o.ev,{children:F.from_email})]})}),(0,v.jsx)(o.b7,{xs:"12",children:(0,v.jsxs)(o.We,{children:[(0,v.jsx)(o.cc,{htmlFor:"from_name",children:"From Name"}),(0,v.jsx)(o.C$,{id:"from_name",name:"from_name",onChange:k,onBlur:P,value:z.from_name,invalid:Z.from_name&&F.from_name}),(0,v.jsx)(o.ev,{children:F.from_name})]})}),(0,v.jsxs)(o.b7,{xs:"12",children:[(0,v.jsx)(h.Z,{disabled:!0,style:{width:"1px",height:"1px",visibility:"hidden"},type:"text",name:"template_body",onChange:k,onBlur:P,value:z.template_body,invalid:Z.template_body&&F.template_body}),(0,v.jsx)(x.Editor,{editorState:y,toolbarClassName:"toolbarClassName",wrapperClassName:"wrapperClassName",editorClassName:"editorClassName",onEditorStateChange:function(e){S(e);var a=j()((0,f.convertToRaw)(e.getCurrentContent()));console.log("..htmlContent.."+a),I((0,r.Z)((0,r.Z)({},z),{},{template_body:a}))},toolbar:{options:["inline","fontSize","fontFamily","list","textAlign","colorPicker","link","image"],link:{defaultTargetOption:"_blank",popupClassName:"mail-editor-link"},image:{urlEnabled:!0,uploadEnabled:!0,uploadCallback:A,alignmentEnabled:!0,defaultSize:{height:"auto",width:"600px"},inputAccept:"application/pdf,text/plain,application/vnd.openxmlformatsofficedocument.wordprocessingml.document,application/msword,application/vnd.ms-excel,image/gif,image/jpeg,image/jpg,image/png,image/svg"}}})]})]}),(0,v.jsxs)(o.Bt,{className:"text-right",children:[(0,v.jsx)(o.u5,{disabled:!B||D,type:"submit",size:"sm",color:"primary",children:D?(0,v.jsx)(o.LQ,{size:"sm"}):"Submit"})," ",(0,v.jsx)(o.u5,{type:"reset",size:"sm",color:"danger",onClick:function(){return T()},children:"Reset"})]})]})})})}),(0,v.jsxs)(o.rb,{children:[(0,v.jsx)("br",{})," ",(0,v.jsx)("br",{})," ",(0,v.jsx)("br",{})," ",(0,v.jsx)("br",{})," ",(0,v.jsx)("br",{})]})]})})})}),(0,v.jsx)(g.Wm,{})]})]})}},83309:function(){}}]);
//# sourceMappingURL=250.3ac61127.chunk.js.map