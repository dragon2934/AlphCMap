"use strict";(self.webpackChunkproperty_manage_system_web=self.webpackChunkproperty_manage_system_web||[]).push([[70],{28958:function(e,n,t){t.d(n,{Z:function(){return l}});var r=t(74569),a=t.n(r)().create({headers:{"Content-type":"application/json"}}),s=t(83708),l={upload:function(e,n,t){var r=new FormData;return r.append("files",e),a.post(s.rq+"/upload",r,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(n)},onUploadProgress:t})},getFiles:function(e){return a.get(s.rq+"/upload/files?_limit=10&_start=0&_sort=updatedAt:DESC")}}},57070:function(e,n,t){t.r(n),t.d(n,{default:function(){return h}});var r=t(72791),a=t(14934),s=t(74165),l=t(93433),i=t(15861),c=t(29439),o=t(28958),u=t(15301),d=t(60364),f=t(80184),p=function(){var e=(0,r.useState)(void 0),n=(0,c.Z)(e,2),t=n[0],a=n[1],p=(0,r.useState)({val:[]}),h=(0,c.Z)(p,2),m=h[0],g=h[1],v=(0,r.useState)([]),x=(0,c.Z)(v,2),j=x[0],y=x[1],N=(0,r.useState)([]),b=(0,c.Z)(N,2),Z=b[0],w=b[1],S=(0,r.useRef)(null),C=(0,d.useDispatch)(),_=(0,d.useSelector)((function(e){return e.auth.jwt}));(0,r.useEffect)((function(){C((0,u.C7)()).then((function(e){w(e.data)}))}),[]);var J=function(){var e=(0,i.Z)((0,s.Z)().mark((function e(n,r){var a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,l.Z)(S.current.val),console.log("uploading ..file="+JSON.stringify(r)),e.abrupt("return",o.Z.upload(r,_,(function(e){a[n].percentage=Math.round(100*e.loaded/e.total),g({val:a})})).then((function(e){y((function(e){return[].concat((0,l.Z)(e),["Uploaded the file successfully: "+r.name])})),C((0,u.bv)(r.name,e.data[0].url)).then((function(e){console.log(" update property.."+JSON.stringify(e));var r=Array.from(t);(n+=1)<r.length?(L(500),J(n,r[n])):(y((function(e){return[].concat((0,l.Z)(e),["Uploaded Completed,now update Lat/Lng for the property, please wait.... "])})),C((0,u.Kl)()).then((function(e){y((function(e){return[].concat((0,l.Z)(e),["update Lat/Lng successful "])}))})).catch((function(e){y((function(n){return[].concat((0,l.Z)(n),["update Lat/Lng error: "+JSON.stringify(e)])}))})))})).catch((function(e){console.log("update property error.."+JSON.stringify(e))}))})).catch((function(e){console.log("upload file error.."+JSON.stringify(e)),a[n].percentage=0,g({val:a}),y((function(e){return[].concat((0,l.Z)(e),["Could not upload the file: "+r.name])}))})));case 3:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),L=function(e){return new Promise((function(n){return setTimeout(n,e)}))};return(0,f.jsxs)("div",{children:[m&&m.val.length>0&&m.val.map((function(e,n){return(0,f.jsxs)("div",{className:"mb-2",children:[(0,f.jsx)("span",{children:e.fileName}),(0,f.jsx)("div",{className:"progress",children:(0,f.jsxs)("div",{className:"progress-bar progress-bar-info",role:"progressbar","aria-valuenow":e.percentage,"aria-valuemin":"0","aria-valuemax":"100",style:{width:e.percentage+"%"},children:[e.percentage,"%"]})})]},n)})),(0,f.jsxs)("div",{className:"row my-3",children:[(0,f.jsx)("div",{className:"col-8",children:(0,f.jsx)("label",{className:"btn btn-default p-0",children:(0,f.jsx)("input",{type:"file",multiple:!0,onChange:function(e){a(e.target.files),console.log("file selected.."+JSON.stringify(e.target.files)),g({val:[]})}})})}),(0,f.jsx)("div",{className:"col-4",children:(0,f.jsx)("button",{className:"btn btn-success btn-sm",disabled:!t,onClick:function(){var e=Array.from(t);console.log("files..."+JSON.stringify(e));var n=e.map((function(e){return{percentage:0,fileName:e.name}}));S.current={val:n},J(0,e[0])},children:"Upload"})})]}),j.length>0&&(0,f.jsx)("div",{className:"alert alert-secondary",role:"alert",children:(0,f.jsx)("ul",{children:j.map((function(e,n){return(0,f.jsx)("li",{children:e},n)}))})}),(0,f.jsxs)("div",{className:"card",children:[(0,f.jsx)("div",{className:"card-header",children:"List of Files"}),(0,f.jsx)("ul",{className:"list-group list-group-flush",children:Z&&Z.map((function(e,n){return(0,f.jsx)("li",{className:"list-group-item",children:(0,f.jsx)("a",{href:e.url,children:e.name})},n)}))})]})]})},h=function(){return(0,f.jsxs)("main",{children:[(0,f.jsx)(a.Z,{}),(0,f.jsx)("div",{className:"content",children:(0,f.jsxs)("div",{className:"container",style:{width:"600px"},children:[(0,f.jsx)("div",{className:"my-3",children:(0,f.jsx)("h4",{children:"PDF Files Upload"})}),(0,f.jsx)(p,{})]})})]})}}}]);
//# sourceMappingURL=70.7021d8f0.chunk.js.map