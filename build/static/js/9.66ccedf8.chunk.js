"use strict";(self.webpackChunkproperty_manage_system_web=self.webpackChunkproperty_manage_system_web||[]).push([[9],{69062:function(e,n,s){s(56994),s(72791);var r=s(56153),i=s(27988),t=s(81815),l=(s(60364),s(57577)),o=s(80184);n.Z=function(e){e.id;var n=e.email,s=e.property,a=e.cb,c=(e.changeColor,e.editMode),d=e.cbBinding,u=e.cbSendEmail,h=e.cbBusiness,m=e.user,p=e.cbBusinessInfo;console.log("....render property.."+JSON.stringify(s));(0,l.getLoginType)();return"grey"===s.color?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h4",{children:n}),(0,o.jsxs)(r.Z,{className:"justify-content-end",children:[(0,o.jsx)(i.Z,{className:"bindingInfo",children:" Pending Customer "}),(0,o.jsx)(i.Z,{children:(0,o.jsx)(t.Z,{color:"danger",size:"sm",onClick:function(){return a(n,!1)},children:"Remove"})})]})]}):c?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h4",{children:n}),(0,o.jsxs)(r.Z,{className:"justify-content-end",children:[s.bindingName&&null!==s.bindingName&&"null"!==s.bindingName?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Name: ",s.bindingName,"  "]}):null,s.bindingEmail&&null!==s.bindingEmail&&"null"!==s.bindingEmail?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Email: ",s.bindingEmail,"   "]}):null]}),(0,o.jsxs)(r.Z,{className:"justify-content-end",children:[s.bindingPhone&&null!==s.bindingPhone&&"null"!==s.bindingPhone?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Phone: ",s.bindingPhone,"  "]}):null,s.bindingOthers&&null!==s.bindingOthers&&"null"!==s.bindingOthers?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Others: ",s.bindingOthers,"  "]}):null]}),(0,o.jsx)(r.Z,{className:"justify-content-end",children:(0,o.jsx)(i.Z,{className:"list-unstyled text-right",children:(0,o.jsxs)("li",{children:[s.bindingEmail&&null!==s.bindingEmail&&"null"!==s.bindingEmail?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.Z,{size:"sm",onClick:function(e){return u(e,s)},children:"Send Email"})," \xa0\xa0\xa0\xa0"]}):null,null!==m&&void 0!==m&&s.id===m.property.id?(0,o.jsxs)(o.Fragment,{children:["  ",(0,o.jsx)(t.Z,{size:"sm",onClick:function(){return h(n,s)},children:"Business"})," \xa0\xa0\xa0\xa0"]}):null,(0,o.jsx)(t.Z,{size:"sm",onClick:function(){d(n,s)},children:"Info"})," \xa0\xa0\xa0\xa0",1!==s.usuage&&3!==s.usuage||s.primary?null:(0,o.jsx)(t.Z,{color:"danger",size:"sm",onClick:function(){return a(n,!1)},children:"Remove"})]})})})]}):s.is_business?"0"===s.connected?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h4",{children:n}),(0,o.jsxs)(r.Z,{className:"justify-content-end",children:[s.bindingName&&null!==s.bindingName&&"null"!==s.bindingName?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Name: ",s.bindingName,"  "]}):null,s.bindingEmail&&null!==s.bindingEmail&&"null"!==s.bindingEmail?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Email: ",s.bindingEmail,"   "]}):null]}),(0,o.jsxs)(r.Z,{className:"justify-content-end",children:[s.bindingPhone&&null!==s.bindingPhone&&"null"!==s.bindingPhone?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Phone: ",s.bindingPhone,"  "]}):null,s.bindingOthers&&null!==s.bindingOthers&&"null"!==s.bindingOthers?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Others: ",s.bindingOthers,"  "]}):null]}),(0,o.jsx)(t.Z,{size:"sm",onClick:function(){p(n,s)},children:"Info"}),"  "]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h4",{children:n}),(0,o.jsxs)(r.Z,{className:"justify-content-end",children:[s.bindingName&&null!==s.bindingName&&"null"!==s.bindingName?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Name: ",s.bindingName,"  "]}):null,s.bindingEmail&&null!==s.bindingEmail&&"null"!==s.bindingEmail?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Email: ",s.bindingEmail,"   "]}):null]}),(0,o.jsxs)(r.Z,{className:"justify-content-end",children:[s.bindingPhone&&null!==s.bindingPhone&&"null"!==s.bindingPhone?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Phone: ",s.bindingPhone,"  "]}):null,s.bindingOthers&&null!==s.bindingOthers&&"null"!==s.bindingOthers?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Others: ",s.bindingOthers,"  "]}):null]}),(0,o.jsx)(t.Z,{size:"sm",onClick:function(){p(n,s)},children:"Info"})]}):s.primary?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h4",{children:n}),(0,o.jsxs)(r.Z,{className:"justify-content-end",children:[s.bindingName&&null!==s.bindingName&&"null"!==s.bindingName?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Name: ",s.bindingName,"  "]}):null,s.bindingEmail&&null!==s.bindingEmail&&"null"!==s.bindingEmail?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Email: ",s.bindingEmail,"   "]}):null]}),(0,o.jsxs)(r.Z,{className:"justify-content-end",children:[s.bindingPhone&&null!==s.bindingPhone&&"null"!==s.bindingPhone?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Phone: ",s.bindingPhone,"  "]}):null,s.bindingOthers&&null!==s.bindingOthers&&"null"!==s.bindingOthers?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Others: ",s.bindingOthers,"  "]}):null]})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h4",{children:n}),(0,o.jsxs)(r.Z,{className:"justify-content-end",children:[s.bindingName&&null!==s.bindingName&&"null"!==s.bindingName?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Name: ",s.bindingName,"  "]}):null,s.bindingEmail&&null!==s.bindingEmail&&"null"!==s.bindingEmail?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Email: ",s.bindingEmail,"   "]}):null]}),(0,o.jsxs)(r.Z,{className:"justify-content-end",children:[s.bindingPhone&&null!==s.bindingPhone&&"null"!==s.bindingPhone?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Phone: ",s.bindingPhone,"  "]}):null,s.bindingOthers&&null!==s.bindingOthers&&"null"!==s.bindingOthers?(0,o.jsxs)(i.Z,{className:"bindingInfo",children:["Others: ",s.bindingOthers,"  "]}):null]}),(0,o.jsx)(r.Z,{className:"justify-content-end",children:(0,o.jsx)(i.Z,{className:"list-unstyled text-right",children:(0,o.jsx)("li",{children:(0,o.jsx)(t.Z,{color:"danger",size:"sm",onClick:function(){return a(n,!1)},children:"Remove"})})})})]})}},47569:function(e,n,s){var r=s(74165),i=s(93433),t=s(15861),l=s(29439),o=s(72791),a=s(28958),c=s(15301),d=s(60364),u=s(80184);n.Z=function(e){var n=e.extension,s=(0,o.useState)(void 0),h=(0,l.Z)(s,2),m=h[0],p=h[1],g=(0,o.useState)({val:[]}),x=(0,l.Z)(g,2),f=x[0],j=x[1],Z=(0,d.useSelector)((function(e){return e.admin.uploadedFiles})),b=(0,o.useState)([]),y=(0,l.Z)(b,2),v=y[0],N=y[1],k=(0,o.useState)([]),C=(0,l.Z)(k,2),w=(C[0],C[1]),S=(0,o.useRef)(null),P=(0,d.useDispatch)(),T=(0,d.useSelector)((function(e){return e.auth.jwt}));console.log("extension ="+n),(0,o.useEffect)((function(){P((0,c.C7)()).then((function(e){w(e.data)}))}),[]);var I=function(){var e=(0,t.Z)((0,r.Z)().mark((function e(n,s){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,i.Z)(S.current.val),console.log("uploading ..file="+JSON.stringify(s)),e.abrupt("return",a.Z.upload(s,T,(function(e){t[n].percentage=Math.round(100*e.loaded/e.total),j({val:t})})).then((function(e){N((function(e){return[].concat((0,i.Z)(e),["Uploaded the file successfully: "+s.name])}));var r={id:e.data[0].id,url:e.data[0].url};Z.push(r);var t=Array.from(m);(n+=1)<t.length?(F(500),I(n,t[n])):N((function(e){return[].concat((0,i.Z)(e),["Uploaded Completed!"])}))})).catch((function(e){console.log("upload file error.."+JSON.stringify(e)),t[n].percentage=0,j({val:t}),N((function(e){return[].concat((0,i.Z)(e),["Could not upload the file: "+s.name])}))})));case 3:case"end":return e.stop()}}),e)})));return function(n,s){return e.apply(this,arguments)}}(),F=function(e){return new Promise((function(n){return setTimeout(n,e)}))};return(0,u.jsxs)("div",{children:[f&&f.val.length>0&&f.val.map((function(e,n){return(0,u.jsxs)("div",{className:"mb-2",children:[(0,u.jsx)("span",{children:e.fileName}),(0,u.jsx)("div",{className:"progress",children:(0,u.jsxs)("div",{className:"progress-bar progress-bar-info",role:"progressbar","aria-valuenow":e.percentage,"aria-valuemin":"0","aria-valuemax":"100",style:{width:e.percentage+"%"},children:[e.percentage,"%"]})})]},n)})),(0,u.jsxs)("div",{className:"row my-3",children:[(0,u.jsx)("div",{className:"col-8",children:(0,u.jsx)("label",{className:"btn btn-default p-0",children:(0,u.jsx)("input",{type:"file",accept:n,multiple:!0,onChange:function(e){p(e.target.files),console.log("file selected.."+JSON.stringify(e.target.files)),j({val:[]})}})})}),(0,u.jsx)("div",{className:"col-4",children:(0,u.jsx)("button",{className:"btn btn-success btn-sm",disabled:!m,onClick:function(e){e.preventDefault();var n=Array.from(m);console.log("files..."+JSON.stringify(n));var s=n.map((function(e){return{percentage:0,fileName:e.name}}));S.current={val:s},I(0,n[0])},children:"Upload"})})]}),v.length>0&&(0,u.jsx)("div",{className:"alert alert-secondary",role:"alert",children:(0,u.jsx)("ul",{children:v.map((function(e,n){return(0,u.jsx)("li",{children:e},n)}))})})]})}},28958:function(e,n,s){s.d(n,{Z:function(){return l}});var r=s(74569),i=s.n(r)().create({headers:{"Content-type":"application/json"}}),t=s(83708),l={upload:function(e,n,s){var r=new FormData;return r.append("files",e),i.post(t.rq+"/upload",r,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(n)},onUploadProgress:s})},getFiles:function(e){return i.get(t.rq+"/upload/files?_limit=10&_start=0&_sort=updatedAt:DESC")}}},2263:function(e,n,s){var r=s(29439),i=s(5483),t=s.n(i),l=s(72791),o=s(74230),a=s(18099),c=s(80184);t().accessToken="pk.eyJ1IjoieWt1cnNhdCIsImEiOiJjam9rMmFrZGkwMmpjM3F0b3huZ2hkM2VnIn0.tuCDaZM6aIA2KQZbtucKpQ";n.Z=function(e){var n=e.className,s=(0,l.useState)(null),i=(0,r.Z)(s,2),d=i[0],u=i[1],h=(0,l.useRef)(null),m=(0,l.useContext)(o.ZP);return(0,l.useLayoutEffect)((function(){document.onresize=function(){m.map.resize()}})),(0,l.useEffect)((function(){d||function(e){var n=e.setMap,s=e.mapContainer,r=new(t().Map)({container:s.current,style:"mapbox://styles/mapbox/streets-v11",center:[-79.4164156,43.63982499999999],zoom:7,attributionControl:!1}),i=new(t().NavigationControl)({showCompass:!1,showZoom:!0});r.addControl(i,"bottom-right"),r.on("load",(function(){n(r),m.setMap(r),r.resize()})),console.log("Map Init......")}({setMap:u,mapContainer:h})}),[m,d]),(0,c.jsxs)("div",{className:"d-flex flex-fill ".concat(n||""),children:[(0,c.jsx)(a.Z,{}),(0,c.jsx)("div",{className:"flex-fill",ref:function(e){return h.current=e}})]})}},24219:function(e,n,s){s.d(n,{Z:function(){return x}});s(72791);var r=s(75611),i=s(14934),t=s(60364),l=s(64880),o=s(62298),a=s(95234),c=s(81815),d=s(56153),u=s(58031),h=s(92299),m=s(2138),p=s(80184),g=function(){var e=(0,l.k6)(),n=(0,t.useDispatch)(),s=(0,t.useSelector)((function(e){return e.app.showVerificationModal})),r=(0,t.useSelector)((function(e){return e.registerForm.user})),i=(0,t.useSelector)((function(e){return e.auth.user}));if(r)return null;if(!i)return null;var g=i.username!==i.email,x=g&&i.emailVerified&&i.mobileVerified||!g&&i.mobileVerified;return s?(0,p.jsx)(o.Z,{size:"lg",isOpen:!0,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:(0,p.jsxs)(a.Z,{children:[!x&&(0,p.jsx)("div",{className:"pb-3",children:"Please verify your email and mobile phone to start using website."}),(0,p.jsx)(h.Z,{}),(0,p.jsx)(m.Z,{}),x&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"success mt-5 mb-3",children:"Verification Successful!"}),(0,p.jsx)(c.Z,{block:!0,color:"success",onClick:function(){try{window.ReactNativeWebView.postMessage(JSON.stringify({action:"goBack"}))}catch(s){}n((0,u.mk)()),localStorage.setItem("show_login_tips",2),setTimeout((function(){e.push("/logout")}),500)},children:"Login and Complete Business Profile"})]}),!x&&(0,p.jsx)(d.Z,{noGutters:!0,className:"justify-content-end",children:(0,p.jsx)(c.Z,{color:"link",size:"sm",onClick:function(){e.push("/logout")},children:"Logout"})})]})}):null},x=function(e){var n=e.children;return(0,p.jsxs)("main",{children:[(0,p.jsx)(i.Z,{}),(0,p.jsx)("div",{className:"content",children:n}),(0,p.jsx)(r.Z,{}),(0,p.jsx)(g,{})]})}},96391:function(e,n,s){s.r(n),s.d(n,{default:function(){return Je}});var r=s(29439),i=s(72791),t=s(60364),l=s(64880),o=s(99574),a=s(71757),c=s(2053),d=s(24219),u=s(93433),h=s(1413),m=s(74165),p=s(15861),g=s(15671),x=s(43144),f=s(97326),j=s(60136),Z=s(98557),b=s(5483),y=s.n(b),v=s(2263),N=s(74230),k=s(15301),C=s(5329),w=s(57577),S=s(34641),P=s(69062),T=s(91523),I=s(69362),F=s.n(I),B=s(27988),M=s(70456),A=s(44517),_=s(54555),E=s(39132),O=s(73002),D=s(81778),R=s(81815),U=s(42937),z=s(64064),L=s(35390),V=s(80184),J=z.Ry().shape({}),W=function(e){var n=e.wizardInstance,s=(0,t.useDispatch)(),r=(0,t.useSelector)((function(e){return e.registerForm})),i=r.address,l=r.rural,o=(0,t.useSelector)((function(e){return e.utilsData}));i.steps=1;var a=(0,M.TA)({initialValues:i,validationSchema:J,onSubmit:function(e,r){(0,r.setSubmitting)(!0),s((0,L.ZF)({address:(0,h.Z)((0,h.Z)({},i),e)})),n.nextStep()}}),c=a.handleChange,d=a.handleBlur,u=a.handleSubmit,m=a.errors,p=a.touched,g=a.values,x=a.isValid,f=a.isSubmitting,j=function(){s((0,L.ZF)({address:(0,h.Z)((0,h.Z)({},i),g)})),d.apply(void 0,arguments)};return(0,V.jsxs)(A.Z,{onSubmit:u,children:[(0,V.jsx)(B.Z,{children:(0,V.jsx)(_.Z,{type:"hidden",value:1,name:"steps"})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"postalCode",children:"Postal Code"}),(0,V.jsx)(_.Z,{type:"text",name:"postalCode",id:"postalCode",onChange:c,onBlur:j,value:g.postalCode,invalid:p.postalCode&&m.postalCode,placeholder:""}),(0,V.jsx)(D.Z,{children:m.postalCode})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"postalCode",children:"Street Number"}),(0,V.jsx)(_.Z,{type:"text",name:"streetNumber",id:"streetNumber",onChange:c,onBlur:j,value:g.streetNumber,invalid:p.streetNumber&&m.streetNumber,placeholder:""}),(0,V.jsx)(D.Z,{children:m.streetNumber})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"route",children:"Street /Route / Lot No / Plot No / Local Identifier"}),(0,V.jsx)(_.Z,{type:"text",name:"route",id:"route",onChange:c,onBlur:j,value:g.route,invalid:p.route&&m.route,placeholder:""}),(0,V.jsx)(D.Z,{children:m.route})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"route",children:" City / Locality"}),(0,V.jsx)(_.Z,{type:"text",name:"locality",id:"locality",onChange:c,onBlur:j,value:g.locality,invalid:p.locality&&m.locality,placeholder:""}),(0,V.jsx)(D.Z,{children:m.locality})]})}),l&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"lotNo",children:"Lot No"}),(0,V.jsx)(_.Z,{type:"text",name:"lotNo",id:"lotNo",onChange:c,onBlur:j,value:g.lotNo,invalid:p.lotNo&&m.lotNo,placeholder:""}),(0,V.jsx)(D.Z,{children:m.lotNo})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"plotNo",children:"Plot No"}),(0,V.jsx)(_.Z,{type:"text",name:"plotNo",id:"plotNo",onChange:c,onBlur:j,value:g.plotNo,invalid:p.plotNo&&m.plotNo,placeholder:""}),(0,V.jsx)(D.Z,{children:m.plotNo})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"region",children:"Region"}),(0,V.jsx)(_.Z,{type:"text",name:"region",id:"region",onChange:c,onBlur:j,value:g.region,invalid:p.region&&m.region,placeholder:""}),(0,V.jsx)(D.Z,{children:m.region})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"province",children:"Province"}),(0,V.jsx)(_.Z,{type:"text",name:"province",id:"province",onChange:c,onBlur:j,value:g.province,invalid:p.province&&m.province,placeholder:""}),(0,V.jsx)(D.Z,{children:m.province})]})})]}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"route",children:"Province / State"}),(0,V.jsx)(_.Z,{type:"text",name:"city",id:"city",onChange:c,onBlur:j,value:g.city,invalid:p.city&&m.city,placeholder:""}),(0,V.jsx)(D.Z,{children:m.city})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"route",children:"Country"}),(0,V.jsx)(_.Z,{type:"text",name:"country",id:"country",onChange:c,onBlur:j,value:g.country,invalid:p.country&&m.country,placeholder:""}),(0,V.jsx)(D.Z,{children:m.country})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{block:!0,disabled:!x||f,children:f?(0,V.jsx)(U.Z,{size:"sm"}):"Next"})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{className:"mt-1 mb-5",color:"danger",block:!0,onClick:function(){o.connectToMerchantId=0,s((0,L.Oi)())},children:"Cancel"})}),o.connectToMerchantId>0?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(B.Z,{children:(0,V.jsx)(O.Z,{for:"route",children:" ---------------- OR ----------------- "})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{className:"mt-1 mb-5",block:!0,onClick:function(){i.noDelivery=1,i.property=o.selectedProperty,n.goToStep(3)},children:"No Delivery"})})]}):null]})},q=s(45987),H=s(37496),G=s(48663),Q=["unitNo"],K=["unitNo"],Y=["unitNo"],$=function(e){var n=e.wizardInstance,s=(0,t.useDispatch)(),l=(0,t.useSelector)((function(e){return e.registerForm})).address,o=(0,t.useSelector)((function(e){return e.utilsData}));l.steps=2;(0,S.Jk)(l);var a=(0,M.TA)({initialValues:{primaryAddress:!0,hightRiseOrCommercial:!1,propertyName:"",totalFloors:"1",totalUnitsEachFloor:"1",addressType:"",settlementType:"",unitNo:""},isInitialValid:!1,validationSchema:G.G,onSubmit:function(e,r){var i=r.setSubmitting;i(!0);var t=(0,S.Jk)(l);if(console.log("email="+t),e.hightRiseOrCommercial)s((0,L.OS)(t)).then((function(r){if(r.value.registered)m("This address is already registered! Please contact property management"),i(!1);else{"lowRise"===e.settlementType&&(e.unitNo="");var t=e.unitNo,o=(0,q.Z)(e,Q);s((0,L.ZF)((0,h.Z)((0,h.Z)({},o),{},{address:(0,h.Z)((0,h.Z)({},l),{},{unitNo:t})}))),n.nextStep()}})).catch((function(e){console.log("check property error"+e),m(JSON.stringify(e)),i(!1)}));else if("highRise"==e.settlementType)t=e.unitNo+"-"+t,s((0,L.OS)(t)).then((function(r){if(r.value.registered)m("This address is already registered! Please contact anything@alphc.com"),i(!1);else{"lowRise"===e.settlementType&&(e.unitNo="");var t=e.unitNo,o=(0,q.Z)(e,K);s((0,L.ZF)((0,h.Z)((0,h.Z)({},o),{},{address:(0,h.Z)((0,h.Z)({},l),{},{unitNo:t})}))),n.nextStep()}})).catch((function(e){console.log("check property error"+e),m(JSON.stringify(e)),i(!1)}));else{"lowRise"===e.settlementType&&(e.unitNo="");var o=e.unitNo,a=(0,q.Z)(e,Y);s((0,L.ZF)((0,h.Z)((0,h.Z)({},a),{},{address:(0,h.Z)((0,h.Z)({},l),{},{unitNo:o})}))),n.nextStep()}}}),c=(0,i.useState)(""),d=(0,r.Z)(c,2),u=d[0],m=d[1],p=a.handleChange,g=a.handleBlur,x=a.handleSubmit,f=a.errors,j=a.touched,Z=a.isValid,b=a.isSubmitting,y=a.setFieldValue,v=a.values;return(0,V.jsxs)(A.Z,{onSubmit:x,children:[(0,V.jsx)(B.Z,{children:(0,V.jsx)(_.Z,{type:"hidden",value:2,name:"steps"})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(E.Z,{tag:"fieldset",children:(0,V.jsx)(E.Z,{check:!0,children:(0,V.jsxs)(O.Z,{check:!0,children:[(0,V.jsx)(_.Z,{type:"checkbox",name:"primaryAddress",onChange:function(e){y("primaryAddress",e.currentTarget.checked)},checked:v.primaryAddress,onBlur:g,invalid:j.primaryAddress&&f.primaryAddress}),"This is my primary address"]})})})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(H.Z,{isOpen:!1===v.hightRiseOrCommercial,children:(0,V.jsxs)(E.Z,{tag:"fieldset",children:[(0,V.jsx)(O.Z,{for:"postalCode",children:"Address Type"}),(0,V.jsx)(E.Z,{check:!0,children:(0,V.jsxs)(O.Z,{check:!0,children:[(0,V.jsx)(_.Z,{type:"radio",name:"addressType",onChange:p,onBlur:g,value:"residential",invalid:j.addressType&&f.addressType}),"Residential"]})}),(0,V.jsx)(E.Z,{check:!0,children:(0,V.jsxs)(O.Z,{check:!0,children:[(0,V.jsx)(_.Z,{type:"radio",name:"addressType",onChange:p,onBlur:g,value:"commercial",invalid:j.addressType&&f.addressType}),"Commercial"]})}),(0,V.jsx)(E.Z,{check:!0,children:(0,V.jsxs)(O.Z,{check:!0,children:[(0,V.jsx)(_.Z,{type:"radio",name:"addressType",onChange:p,onBlur:g,value:"School",invalid:j.addressType&&f.addressType}),"School"]})})]})})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(H.Z,{isOpen:"Incorporate"===v.addressType||"School"===v.addressType,children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"lblPropertyName",children:"Name"}),(0,V.jsx)(_.Z,{type:"text",name:"propertyName",onChange:p,onBlur:g,value:v.propertyName,invalid:j.propertyName&&f.propertyName}),(0,V.jsx)(D.Z,{children:f.propertyName})]})})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{tag:"fieldset",children:[(0,V.jsx)(O.Z,{for:"postalCode",children:"Settlement Type"}),(0,V.jsx)(H.Z,{isOpen:!1===v.hightRiseOrCommercial,children:(0,V.jsx)(E.Z,{check:!0,children:(0,V.jsxs)(O.Z,{check:!0,children:[(0,V.jsx)(_.Z,{type:"radio",name:"settlementType",onChange:p,onBlur:g,value:"lowRise",invalid:j.settlementType&&f.settlementType}),"Single Dwelling"]})})}),(0,V.jsx)(E.Z,{check:!0,children:(0,V.jsxs)(O.Z,{check:!0,children:[(0,V.jsx)(_.Z,{type:"radio",name:"settlementType",onChange:p,onBlur:g,value:"highRise",invalid:j.settlementType&&f.settlementType}),"High Rise / Multiple Units"]})})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(H.Z,{isOpen:"highRise"===v.settlementType,children:v.hightRiseOrCommercial?(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"totalFloors",children:"Total Floors"}),(0,V.jsx)(_.Z,{type:"text",name:"totalFloors",onChange:p,onBlur:g,value:v.totalFloors,invalid:j.totalFloors&&f.totalFloors}),(0,V.jsx)(D.Z,{children:f.totalFloors})]}),(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"totalUnitsEachFloor",children:"Total Units each floor"}),(0,V.jsx)(_.Z,{type:"text",name:"totalUnitsEachFloor",onChange:p,onBlur:g,value:v.totalUnitsEachFloor,invalid:j.totalUnitsEachFloor&&f.totalUnitsEachFloor}),(0,V.jsx)(D.Z,{children:f.totalUnitsEachFloor})]})]})}):(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"postalCode",children:"Unit No"}),(0,V.jsx)(_.Z,{type:"text",name:"unitNo",onChange:p,onBlur:g,value:v.unitNo,invalid:j.unitNo&&f.unitNo}),(0,V.jsx)(D.Z,{children:f.unitNo})]})})})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(H.Z,{isOpen:u.length>0,children:(0,V.jsx)(O.Z,{color:"danger",for:"errorMessage",children:u})})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{block:!0,disabled:!Z||b,children:b?(0,V.jsx)(U.Z,{size:"sm"}):"Next"})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{className:"mt-1 mb-5",color:"danger",block:!0,onClick:function(){o.connectToMerchantId=0,s((0,L.Oi)())},children:"Cancel"})})]})},X=s(58031),ee=function(){var e=(0,t.useDispatch)(),n=(0,l.k6)();return(0,V.jsx)(V.Fragment,{children:(0,V.jsxs)(A.Z,{children:[(0,V.jsx)("div",{className:"success mt-5 mb-3",children:"Registration Successful!"}),(0,V.jsx)(R.Z,{block:!0,color:"success",onClick:function(){window.ReactNativeWebView?setTimeout(n.push("/mobile-verify"),1e3):(e((0,L.Oi)()),e((0,X.mk)()))},children:"Verify your account"})]})})},ne=s(79318),se=s(11027),re=s(36530),ie=z.Ry().shape({mobileNumber:z.Z_().required("Mobile number is required"),email:z.Z_().required("Email is required").email("Invalid email"),companyName:z.Z_(),lastName:z.Z_(),password:z.Z_().min(6,"Password is  too Short!").max(16,"Password is too Long!").required("Password is required"),passwordConfirmation:z.Z_().required("Password confirmation is required").oneOf([z.iH("password"),null],"Passwords must match"),consent:z.O7().required("Confirm you have read Privacy Policy and Terms of Use").oneOf([!0],"Confirm you have read Privacy Policy and Terms of Use.")}),te=function(e){var n=e.wizardInstance,s=(0,t.useDispatch)(),l=(0,t.useSelector)((function(e){return e.registerForm})),o=(0,t.useSelector)((function(e){return e.utilsData}));(0,t.useSelector)((function(e){return e.registerForm})).address.steps=3;var a=(0,M.TA)({initialValues:{mobileNumber:"",companyName:"",lastName:"",email:"",password:"",passwordConfirmation:"",consent:!1,liability:!0},isInitialValid:!1,validationSchema:ie,onSubmit:function(e,r){var i=r.setSubmitting;i(!0);var t={property:(0,h.Z)({email:(0,S.Jk)(l.address),rural:l.rural,primaryAddress:l.primaryAddress,addressType:l.addressType,hightRiseOrCommercial:l.hightRiseOrCommercial,totalFloors:l.totalFloors,propertyName:l.propertyName,totalUnitsEachFloor:l.totalUnitsEachFloor,settlementType:l.settlementType,unitNo:l.unitNo,location:{longitude:l.longitude,latitude:l.latitude}},l.address),mobileNumber:e.mobileNumber,companyName:e.companyName,lastName:e.lastName,email:e.email,username:e.email,password:e.password,provider:"local",connectToMerchantId:o.connectToMerchantId};s((0,L.a$)(t)).then((function(){s((0,se.jo)(2)).then((function(e){console.log(".get me.resp.."+JSON.stringify(e)),s((0,L.ZF)({user:t,me:e.value})).then((function(){n.nextStep()}))})).catch((function(e){re.Rt.error("Error","Mobile Or Password doesn't match, Please verify!")}))})).catch((function(e){if(e.message&&e.message[0].messages&&"Auth.form.error.mobileNumber.taken"===e.message[0].messages[0].id)x("mobileNumber","Mobile No. already registered")})).finally((function(){i(!1)}))}}),c=a.handleChange,d=a.handleBlur,u=a.handleSubmit,m=a.errors,p=a.touched,g=a.values,x=a.setFieldError,f=a.isValid,j=a.isSubmitting,Z=a.setFieldValue,b=a.setFieldTouched,y=(0,i.useState)(!0),v=(0,r.Z)(y,2),N=v[0],k=v[1],C=(0,i.useState)("password"),w=(0,r.Z)(C,2),P=w[0],T=w[1],I=(0,i.useState)(!1),F=(0,r.Z)(I,2),z=(F[0],F[1]),J=function(){"password"==P?(T("text"),k(!1),z(!0)):(T("password"),k(!0),z(!1))};return(0,V.jsxs)(A.Z,{onSubmit:u,children:[(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"mobileNumber",children:"Mobile Number"}),(0,V.jsx)(ne.Z,{setFieldValue:Z,setFieldTouched:b,placeholder:"Mobile Number",name:"mobileNumber",value:g.mobileNumber,invalid:p.mobileNumber&&m.mobileNumber}),(0,V.jsx)(D.Z,{children:m.mobileNumber})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"companyName",children:"Company Name"}),(0,V.jsx)(_.Z,{type:"text",name:"companyName",id:"companyName",value:g.companyName,onChange:c,onBlur:d,invalid:p.companyName&&m.companyName}),(0,V.jsx)(D.Z,{children:m.companyName})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"lastName",children:"Name"}),(0,V.jsx)(_.Z,{type:"text",name:"lastName",id:"lastName",value:g.lastName,onChange:c,onBlur:d,invalid:p.lastName&&m.lastName}),(0,V.jsx)(D.Z,{children:m.lastName})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"email",children:"Email"}),(0,V.jsx)(_.Z,{type:"email",name:"email",id:"email",value:g.email,onChange:c,onBlur:d,invalid:p.email&&m.email,placeholder:"myemail@email.com"}),(0,V.jsx)(D.Z,{children:m.email})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{className:"passwordFormGroup",children:[(0,V.jsx)(O.Z,{for:"password",children:"Password"}),(0,V.jsx)(_.Z,{type:P,name:"password",id:"password",value:g.password,onChange:c,onBlur:d,invalid:p.password&&m.password,placeholder:"********"}),(0,V.jsx)("i",{onClick:J,className:"fa ".concat(N?"fa-eye-slash":"fa-eye")}),(0,V.jsx)(D.Z,{children:m.password})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{className:"passwordFormGroup",children:[(0,V.jsx)(O.Z,{for:"passwordConfirmation",children:"Password Confirmation"}),(0,V.jsx)(_.Z,{type:P,name:"passwordConfirmation",id:"passwordConfirmation",value:g.passwordConfirmation,onChange:c,onBlur:d,invalid:p.passwordConfirmation&&m.passwordConfirmation,placeholder:"********"}),(0,V.jsx)("i",{onClick:J,className:"fa ".concat(N?"fa-eye-slash":"fa-eye")}),(0,V.jsx)(D.Z,{children:m.passwordConfirmation})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(_.Z,{type:"hidden",invalid:m.invalidProperty}),(0,V.jsx)(D.Z,{children:m.invalidProperty})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(E.Z,{tag:"fieldset",children:(0,V.jsxs)(E.Z,{check:!0,children:[(0,V.jsxs)(O.Z,{check:!0,children:[(0,V.jsx)(_.Z,{type:"checkbox",name:"consent",onChange:function(e){b("consent"),Z("consent",e.currentTarget.checked)},checked:g.consent,onBlur:d,invalid:p.consent&&m.consent}),"I've read"," ",(0,V.jsx)("a",{target:"_blank",href:"/privacy-policy",children:"Privacy Policy"})," and"," ",(0,V.jsx)("a",{target:"_blank",href:"/terms-of-use",children:"Terms of Use"}),"."]}),(0,V.jsx)(O.Z,{check:!0})]})})}),(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(_.Z,{type:"hidden",invalid:m.consent}),(0,V.jsx)(D.Z,{children:m.consent})]})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{block:!0,color:"success",disabled:!f||j,children:j?(0,V.jsx)(U.Z,{size:"sm"}):"Create Account"})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{className:"mt-1 mb-5",color:"danger",block:!0,onClick:function(){o.connectToMerchantId=0,s((0,L.Oi)())},children:"Cancel"})})]})},le=function(){var e=(0,i.useState)({enterRight:"animated enterRight",enterLeft:"animated enterLeft",exitRight:"animated exitRight",exitLeft:"animated exitLeft",intro:"animated intro"}),n=(0,r.Z)(e,1)[0],s=(0,i.useState)(),t=(0,r.Z)(s,2),l=t[0],o=t[1];return(0,V.jsxs)(B.Z,{md:3,sm:12,xs:12,className:"overlay-form-container",children:[(0,V.jsx)(T.rU,{to:"/",children:(0,V.jsx)("img",{className:"logo-container",src:"/assets/img/logo-white.png",alt:"logo"})}),(0,V.jsxs)(F(),{className:"step-wizard",transitions:n,isLazyMount:!0,instance:function(e){return o(e)},children:[(0,V.jsx)(W,{wizardInstance:l}),(0,V.jsx)($,{wizardInstance:l}),(0,V.jsx)(te,{wizardInstance:l}),(0,V.jsx)(ee,{wizardInstance:l})]})]})},oe=s(56153),ae=s(54164),ce=s(83708),de=function(e){var n=e.callback,s=(0,t.useSelector)((function(e){return e.utilsData}));console.log("...utilsData.."+JSON.stringify(s));var o=(0,t.useDispatch)(),a=((0,l.k6)(),(0,i.useState)("default")),c=(0,r.Z)(a,2),d=c[0],u=c[1],h=(0,t.useSelector)((function(e){return e.auth.me})),m=(0,i.useCallback)((function(e){console.log("..handle change ..."+e.target.value),u(e.target.value)}));return(0,V.jsxs)(B.Z,{md:3,sm:12,xs:12,className:"overlay-form-container",children:[(0,V.jsx)(T.rU,{to:"/",children:(0,V.jsx)("img",{className:"logo-container",src:"/assets/img/logo-white.png",alt:"logo"})}),(0,V.jsx)(oe.Z,{style:{width:"80%",paddingLeft:"70px"},children:(0,V.jsx)(B.Z,{style:{textAlign:"left"},children:(0,V.jsxs)(E.Z,{tag:"fieldset",children:[(0,V.jsx)(E.Z,{check:!0,children:(0,V.jsxs)(O.Z,{check:!0,children:[(0,V.jsx)(_.Z,{type:"radio",name:"addressType",onChange:m,checked:"checked",value:"default"}),(0,V.jsx)("img",{src:ce.kM.property.default,style:{height:"30px"}})]})}),(0,V.jsx)(E.Z,{check:!0,children:(0,V.jsxs)(O.Z,{check:!0,children:[(0,V.jsx)(_.Z,{type:"radio",name:"addressType",onChange:m,value:"hasInjured"}),(0,V.jsx)("img",{src:ce.kM.property.hasInjured,style:{height:"30px"}})]})}),(0,V.jsx)(E.Z,{check:!0,children:(0,V.jsxs)(O.Z,{check:!0,children:[(0,V.jsx)(_.Z,{type:"radio",name:"addressType",onChange:m,value:"pending"}),(0,V.jsx)("img",{src:ce.kM.property.pending,style:{height:"30px"}})]})}),(0,V.jsx)(E.Z,{check:!0,children:(0,V.jsxs)(O.Z,{check:!0,children:[(0,V.jsx)(_.Z,{type:"radio",name:"addressType",onChange:m,value:"safe"}),(0,V.jsx)("img",{src:ce.kM.property.safe,style:{height:"30px"}})]})})]})})}),(0,V.jsxs)(oe.Z,{children:[(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{className:"mt-1 mb-5",color:"success",block:!0,onClick:function(){var e=s.emailForChangeColor,r={email:e,color:d,ownerMobileNumber:h.mobileNumber};s.changeColor=!1,o((0,X.AN)(r)).then((function(s){console.log("...change color.."+JSON.stringify(s)),setTimeout((function(){n(!0,d,e)}),500)})).catch((function(s){n(!1,d,e),console.log("...change color error.."+JSON.stringify(s))}))},children:"Confirm"})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{className:"mt-1 mb-5",color:"danger",block:!0,onClick:function(){s.changeColor=!1,o((0,X.b)())},children:"Cancel"})})]})]})},ue=z.Ry().shape({bindingName:z.Z_().required("This field is required"),bindingEmail:z.Z_().required("This field is required")}),he=function(e){e.callback;var n=(0,t.useSelector)((function(e){return e.utilsData}));console.log("...utilsData.."+JSON.stringify(n));var s=(0,t.useDispatch)(),o=((0,l.k6)(),(0,i.useState)("default")),a=(0,r.Z)(o,2),c=(a[0],a[1],n.selectedProperty),d=(0,t.useSelector)((function(e){return e.auth.me})),u=(0,M.TA)({initialValues:{bindingUnitNum:null!==c&&void 0!==c&&"null"!==c.bindingUnitNum?c.bindingUnitNum:"",bindingName:null!==c&&void 0!==c&&"null"!==c.bindingName?c.bindingName:"",bindingEmail:null!==c&&void 0!==c&&"null"!==c.bindingEmail?c.bindingEmail:"",bindingPhone:null!==c&&void 0!==c&&"null"!==c.bindingPhone?c.bindingPhone:"",bindingOthers:null!==c&&void 0!==c&&"null"!==c.bindingOthers?c.bindingOthers:""},isInitialValid:!1,validationSchema:ue,onSubmit:function(e,r){(0,r.setSubmitting)(!0),n.bindingProperty=!1;var i=n.emailForChangeColor,t=n.fncCallback,l=(0,h.Z)({email:i,ownerMobileNumber:d.mobileNumber},e);s((0,k.BU)(l)).then((function(e){t&&t()}))}}),m=u.handleChange,p=u.handleBlur,g=u.handleSubmit,x=u.errors,f=u.touched,j=u.isValid,Z=u.isSubmitting,b=u.setFieldValue,y=u.setFieldTouched,v=u.values;return(0,V.jsxs)(B.Z,{md:3,sm:12,xs:12,className:"overlay-form-container",children:[(0,V.jsx)(T.rU,{to:"/",children:(0,V.jsx)("img",{className:"logo-container",src:"/assets/img/logo-white.png",alt:"logo"})}),(0,V.jsxs)(A.Z,{onSubmit:g,children:[(0,V.jsx)(oe.Z,{children:(0,V.jsx)(B.Z,{style:{textAlign:"left"},children:(0,V.jsxs)(E.Z,{tag:"fieldset",children:[(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"lblPropertyName",children:"Unit # \xa0\xa0"}),(0,V.jsx)(_.Z,{type:"text",name:"bindingUnitNum",onChange:m,onBlur:p,value:v.bindingUnitNum,invalid:f.bindingUnitNum&&x.bindinbindingUnitNumgName}),(0,V.jsx)(D.Z,{children:x.bindingUnitNum})]}),(0,V.jsxs)(E.Z,{children:[(0,V.jsxs)(O.Z,{for:"lblPropertyName",children:["Name \xa0\xa0",(0,V.jsx)("span",{className:"item_required",children:"*"})]}),(0,V.jsx)(_.Z,{type:"text",name:"bindingName",onChange:m,onBlur:p,value:v.bindingName,invalid:f.bindingName&&x.bindingName}),(0,V.jsx)(D.Z,{children:x.bindingName})]}),(0,V.jsxs)(E.Z,{children:[(0,V.jsxs)(O.Z,{for:"lblPropertyName",children:["Email \xa0\xa0",(0,V.jsx)("span",{className:"item_required",children:"*"})]}),(0,V.jsx)(_.Z,{type:"text",name:"bindingEmail",onChange:m,onBlur:p,value:v.bindingEmail,invalid:f.bindingEmail&&x.bindingEmail}),(0,V.jsx)(D.Z,{children:x.bindingEmail})]}),(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"lblPropertyName",children:"Phone"}),(0,V.jsx)(ne.Z,{type:"text",name:"bindingPhone",setFieldValue:b,setFieldTouched:y,value:v.bindingPhone,invalid:f.bindingPhone&&x.bindingPhone}),(0,V.jsx)(D.Z,{children:x.bindingPhone})]}),(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"lblPropertyName",children:"Others"}),(0,V.jsx)(_.Z,{type:"text",name:"bindingOthers",onChange:m,onBlur:p,value:v.bindingOthers,invalid:f.bindingOthers&&x.bindingOthers}),(0,V.jsx)(D.Z,{children:x.bindingOthers})]})]})})}),(0,V.jsxs)(oe.Z,{children:[(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{block:!0,disabled:!j||Z,children:Z?(0,V.jsx)(U.Z,{size:"sm"}):"Confirm"})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{className:"mt-1 mb-5",color:"danger",block:!0,onClick:function(){n.bindingProperty=!1,s((0,X.b)())},children:"Cancel"})})]})]})]})},me=s(74434),pe=s.n(me),ge=s(11397),xe=s(56994),fe=s(66023),je=s(51802),Ze=(s(25646),s(199)),be=s.n(Ze),ye=(s(1701),s(72010)),ve=s(74569),Ne=s.n(ve)().create({headers:{"Content-type":"application/json"}}),ke=z.Ry().shape({promotionTitle:z.Z_().required("This field is required"),promotionContent:z.Z_().required("This field is required")}),Ce=function(e){e.callback;var n=(0,t.useSelector)((function(e){return e.utilsData})),s=(0,t.useDispatch)(),o=((0,l.k6)(),(0,i.useState)("default")),a=(0,r.Z)(o,2),c=(a[0],a[1],n.selectedProperty),d=(0,t.useSelector)((function(e){return e.auth.me})),u=(0,t.useSelector)((function(e){return e.auth.jwt})),h="https://rest.klosertoyou.com/api",g=(h.replace("/api",""),localStorage.getItem("current_domain"));void 0!==g&&null!==g||(g="alphc.com");var x=(0,M.TA)({initialValues:{promotionTitle:"",promotionContent:""},isInitialValid:!1,validationSchema:ke,onSubmit:function(e,r){(0,r.setSubmitting)(!0),n.drawFinished=!1;var i=[],t=[],l=[];c.map((function(e){console.log("....flyer form, property.."+JSON.stringify(e)),e.properties.bindingEmail&&(i.push(e.properties.bindingEmail),t.push(e.properties.bindingPhone),l.push(e.properties.userPropertiesId))})),console.log(".. user..",d),i.push(d.email),t.push(d.mobileNumber),l.push(0);var o={emails:i.join(","),phones:t.join(","),properties:l.join(","),promotionTitle:e.promotionTitle,promotionContent:e.promotionContent};s((0,k.$B)(o));var a=n.fncCallback;null!==a&&(console.log("..should trigger call back"),a())}}),f=x.handleChange,j=x.handleBlur,Z=x.handleSubmit,b=x.errors,y=x.touched,v=x.isValid,N=x.isSubmitting,C=(x.setFieldValue,x.values),w=x.setValues,S=(0,i.useState)(ye.EditorState.createEmpty()),P=(0,r.Z)(S,2),I=P[0],F=P[1],z=(0,i.useState)(0),L=(0,r.Z)(z,2),J=(L[0],L[1]),W=(0,i.useState)([]),q=(0,r.Z)(W,2),H=(q[0],q[1],function(){var e=(0,p.Z)((0,m.Z)().mark((function e(n){var s,r;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(s=new FormData).append("files",n),e.next=4,Ne.post(h+"/upload",s,{headers:{Authorization:"Bearer ".concat(u)}});case 4:return r=e.sent,console.log("..imgData.."+JSON.stringify(r)),e.abrupt("return",Promise.resolve({data:{link:"https://rest.klosertoyou.com".concat(r.data[0].url)}}));case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());return(0,V.jsxs)(B.Z,{md:6,sm:12,xs:12,className:"overlay-form-container",children:[(0,V.jsx)(T.rU,{to:"/",children:(0,V.jsx)("img",{className:"logo-container",src:"/assets/img/logo-white.png",alt:"logo"})}),(0,V.jsxs)(A.Z,{onSubmit:Z,children:[(0,V.jsx)(oe.Z,{children:(0,V.jsx)(B.Z,{style:{textAlign:"left"},children:(0,V.jsxs)(E.Z,{tag:"fieldset",children:[(0,V.jsx)(xe.cc,{children:"Send Communication:"}),(0,V.jsx)(xe.GZ,{accent:!0,className:"mb-3",children:c.map((function(e){return(0,V.jsx)(xe.Eb,{children:e.properties.email+"@"+g},e.properties.id)}))})]})})}),(0,V.jsx)(oe.Z,{children:(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"lblPropertyName",children:"Title:"}),(0,V.jsx)(_.Z,{type:"text",name:"promotionTitle",onChange:f,onBlur:j,value:C.promotionTitle,invalid:y.promotionTitle&&b.promotionTitle}),(0,V.jsx)(D.Z,{children:b.promotionTitle})]})})}),(0,V.jsx)(oe.Z,{children:(0,V.jsx)(B.Z,{children:(0,V.jsxs)(E.Z,{children:[(0,V.jsx)(O.Z,{for:"lblPropertyName",children:"Content:"}),(0,V.jsx)(fe.Z,{disabled:!0,style:{width:"1px",height:"1px",visibility:"hidden"},type:"text",name:"promotionContent",onChange:f,onBlur:j,onKeyUp:function(e){return function(e){var n=e.target.value.length;J(n)}(e)},value:C.promotionContent,invalid:y.promotionContent&&b.promotionContent}),(0,V.jsx)(je.Editor,{editorState:I,toolbarClassName:"toolbarClassName",wrapperClassName:"wrapperClassName",editorClassName:"editorClassName",onEditorStateChange:function(e){F(e);var n=be()((0,ye.convertToRaw)(e.getCurrentContent()));console.log("..htmlContent.."+n);var s=C.promotionTitle;w({promotionTitle:s,promotionContent:n})},toolbar:{options:["inline","fontSize","fontFamily","list","textAlign","colorPicker","link","image"],link:{defaultTargetOption:"_blank",popupClassName:"mail-editor-link"},image:{urlEnabled:!0,uploadEnabled:!0,uploadCallback:H,alignmentEnabled:!0,defaultSize:{height:"auto",width:"600px"},inputAccept:"application/pdf,text/plain,application/vnd.openxmlformatsofficedocument.wordprocessingml.document,application/msword,application/vnd.ms-excel,image/gif,image/jpeg,image/jpg,image/png,image/svg"}}}),(0,V.jsx)(D.Z,{children:b.promotionContent})]})})}),(0,V.jsxs)(oe.Z,{children:[(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{block:!0,disabled:!v||N,children:N?(0,V.jsx)(U.Z,{size:"sm"}):"Confirm"})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{className:"mt-1 mb-5",color:"danger",block:!0,onClick:function(){n.drawFinished=!1;var e=n.fncCallback;s((0,X.b)()),null!==e&&(console.log("..should trigger call back"),e())},children:"Cancel"})})]})]})]})},we=s(36459),Se=s(78682),Pe=s(34001),Te=s(80925),Ie=function(e){(0,we.Z)(e);var n=(0,t.useSelector)((function(e){return e.utilsData})),s=(0,t.useDispatch)(),o=n.selectedProperty,a=(0,l.k6)(),c=(0,w.getLoginType)(),d=(0,i.useState)([]),u=(0,r.Z)(d,2),h=u[0],m=u[1],p=(0,t.useSelector)((function(e){return e.auth.me})),g=(0,i.useState)(null),x=(0,r.Z)(g,2),f=x[0],j=x[1],Z=(0,i.useState)(null),b=(0,r.Z)(Z,2),y=b[0],v=b[1],N=(0,i.useState)(!0),C=(0,r.Z)(N,2),S=C[0],P=C[1],I=function(e,n,s){var r=e.filter((function(e){return parseInt(e.dayOfWeek)===n}));if(r&&r.length>0){if(1===s)return r[0].openHour;if(2===s)return r[0].closeHour;if(3===s)return r[0].closed}return""},F=(0,i.useState)([]),M=(0,r.Z)(F,2),A=M[0],_=M[1];(0,i.useEffect)((function(){P(!0);var e=o.email;e=e.replace(o.unit_no+"-",""),console.log("..email is.."+e),1===c&&"highRise"===o.settlement_type&&s((0,k.Eh)(e)).then((function(e){e.value.data;m(e.value.data),P(!1)})),s((0,k.WR)({id:o.id})).then((function(e){console.log("..property ..info.."+JSON.stringify(e.value)),j(e.value.companyProfile),_(e.value.workingHour),P(!1)}));var n={id_type:1,id:o.id};return s((0,k.NH)(n)).then((function(e){console.log("..get total .."+JSON.stringify(e));var n=parseInt(e.value.value[0].iCount)+parseInt(e.value.value2);v(n>0?n:0)})).catch((function(e){})),function(){}}),[s,o]);var E="https://klosertoyou.com/business-portal/"+o.id;localStorage.getItem("current_domain");return h.length>1?(0,V.jsx)(V.Fragment,{children:(0,V.jsxs)(B.Z,{md:6,sm:12,xs:12,className:"overlay-form-container",children:[(0,V.jsx)(T.rU,{to:"/",children:(0,V.jsx)("img",{className:"logo-container",src:"/assets/img/logo-white.png",alt:"logo"})}),(0,V.jsx)(oe.Z,{style:{width:"100%"},children:(0,V.jsxs)(B.Z,{children:[" ",o.email," "]})}),(0,V.jsx)(oe.Z,{style:{width:"100%"},children:(0,V.jsx)(B.Z,{children:(0,V.jsx)(xe.x,{items:h,loading:S,fields:[{key:"unit_no",_classes:"font-weight-bold",label:"Unit #"},{key:"companyName",label:"Company Name"},"businessPhone"],hover:!0,striped:!0,sorter:!0,tableFilter:{placeholder:"Keywords..."},itemsPerPage:10,pagination:!0,clickableRows:!0,onRowClick:function(e){return window.open("https://klosertoyou.com/business-portal/".concat(e.id),"_blank")}})})}),(0,V.jsx)(oe.Z,{children:(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{className:"mt-1 mb-5",color:"danger",block:!0,onClick:function(){n.showBusinessInfo=!1,s((0,X.el)())},children:"Cancel"})})})]})}):(0,V.jsx)(V.Fragment,{children:(0,V.jsxs)(B.Z,{md:6,sm:12,xs:12,className:"overlay-form-container",children:[(0,V.jsx)(Te.Z,{size:256,className:"logo-container",style:{marginTop:"20px",height:"100px",maxWidth:"100%",width:"100%"},value:E,viewBox:"0 0 256 256"}),(0,V.jsx)(oe.Z,{style:{width:"100%"},children:(0,V.jsx)(B.Z,{style:{textAlign:"left"},children:f?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(oe.Z,{children:[(0,V.jsx)(B.Z,{children:(0,V.jsx)("h3",{children:f.companyName})})," "]}),(0,V.jsxs)(oe.Z,{children:["   ",(0,V.jsxs)(B.Z,{children:[(0,V.jsx)("i",{className:"fa-solid fa-address"})," ",(o.unit_no?o.unit_no+" - ":"")+o.street_number+" "+o.route+" "+o.locality+","+o.city+","+o.postal_code," "]})," "]}),(0,V.jsxs)(oe.Z,{children:["   ",(0,V.jsxs)(B.Z,{children:[(0,V.jsx)("i",{className:"fa-solid fa-phone"})," ",f.phone," "]})," "]}),(0,V.jsxs)(oe.Z,{children:["   ",(0,V.jsxs)(B.Z,{children:[(0,V.jsx)("i",{className:"fa-solid fa-globe"})," ",(0,V.jsx)("a",{href:f.website.startsWith("http")?f.website:"https://"+f.website,className:"business_link",children:"Company Website"}),"  "]})," "]}),y?(0,V.jsxs)(oe.Z,{children:["   ",(0,V.jsxs)(B.Z,{children:["Connected: ",y," "]})," "]}):null,(0,V.jsxs)(oe.Z,{children:["   ",(0,V.jsxs)(B.Z,{children:[(0,V.jsx)("i",{className:"fa-solid fa-globe"})," ",(0,V.jsxs)("a",{className:"business_link",href:E,target:"_blank",children:[" ",E]}),void 0!==p&&void 0!==p.property&&o.id===p.property.id?(0,V.jsxs)(V.Fragment,{children:["\xa0\xa0\xa0 share: \xa0",(0,V.jsx)(Se.Z,{url:E,subject:"",body:"body",children:(0,V.jsx)(Pe.Z,{size:32,round:!0})})]}):null]})," "]}),o.email&&null!==o.email&&"null"!==o.email?(0,V.jsx)(oe.Z,{children:(0,V.jsxs)(B.Z,{children:[(0,V.jsx)("i",{className:"fa-solid fa-envelope"})," ",o.email+"@"+f.companyName+".com","1"!==o.connected||void 0!==p&&void 0!==p.property&&o.id===p.property.id?null:(0,V.jsx)(R.Z,{size:"sm",onClick:function(e){return function(e,r){n.drawFinished=!0;var i=[];i.push({properties:r}),n.selectedProperty=i,n.showBusinessInfo=!1,s((0,X.el)())}(0,o)},children:"Send Email"})]})}):null,(0,V.jsxs)(oe.Z,{children:[(0,V.jsx)(B.Z,{children:f.android_url?(0,V.jsx)("a",{href:f.android_url,target:"_blank",children:(0,V.jsx)("img",{className:"app-container",src:"/assets/img/google-play-badge.png",alt:"Android App Download"})}):null}),(0,V.jsx)(B.Z,{children:f.ios_url?(0,V.jsx)("a",{href:f.ios_url,target:"_blank",children:(0,V.jsx)("img",{className:"app-container",src:"/assets/img/appstore-badge.png",alt:"iOS App Download"})}):null})]}),(0,V.jsx)(oe.Z,{children:(0,V.jsxs)(B.Z,{children:[" ",(0,V.jsx)("hr",{})]})}),(0,V.jsxs)(oe.Z,{children:[(0,V.jsx)(B.Z,{md:3,children:(0,V.jsx)(O.Z,{style:{textAlign:"right"},for:"lblPropertyName",children:"Monday:"})}),!0===I(A,0,3)?(0,V.jsxs)(V.Fragment,{children:["       ",(0,V.jsx)(B.Z,{md:9,children:(0,V.jsx)(O.Z,{for:"lblPropertyName",children:"We're Closed "})})]}):(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(B.Z,{md:9,children:(0,V.jsxs)(O.Z,{for:"lblPropertyName",children:[" ",I(A,0,1)," - ",I(A,0,2)," "]})})})]}),(0,V.jsxs)(oe.Z,{children:[(0,V.jsx)(B.Z,{md:3,children:(0,V.jsx)(O.Z,{style:{textAlign:"right"},for:"lblPropertyName",children:"Tuesday:"})}),!0===I(A,1,3)?(0,V.jsxs)(V.Fragment,{children:["       ",(0,V.jsx)(B.Z,{md:9,children:(0,V.jsx)(O.Z,{for:"lblPropertyName",children:"We're Closed "})})]}):(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(B.Z,{md:9,children:(0,V.jsxs)(O.Z,{for:"lblPropertyName",children:[" ",I(A,1,1)," - ",I(A,1,2)," "]})})})]}),(0,V.jsxs)(oe.Z,{children:[(0,V.jsx)(B.Z,{md:3,children:(0,V.jsx)(O.Z,{style:{textAlign:"right"},for:"lblPropertyName",children:"Wednesday:"})}),!0===I(A,2,3)?(0,V.jsxs)(V.Fragment,{children:["       ",(0,V.jsx)(B.Z,{md:9,children:(0,V.jsx)(O.Z,{for:"lblPropertyName",children:"We're Closed "})})]}):(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(B.Z,{md:9,children:(0,V.jsxs)(O.Z,{for:"lblPropertyName",children:[" ",I(A,2,1)," - ",I(A,2,2)," "]})})})]}),(0,V.jsxs)(oe.Z,{children:[(0,V.jsx)(B.Z,{md:3,children:(0,V.jsx)(O.Z,{style:{textAlign:"right"},for:"lblPropertyName",children:"Thursday:"})}),!0===I(A,3,3)?(0,V.jsxs)(V.Fragment,{children:["       ",(0,V.jsx)(B.Z,{md:9,children:(0,V.jsx)(O.Z,{for:"lblPropertyName",children:"We're Closed "})})]}):(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(B.Z,{md:9,children:(0,V.jsxs)(O.Z,{for:"lblPropertyName",children:[" ",I(A,3,1)," - ",I(A,3,2)," "]})})})]}),(0,V.jsxs)(oe.Z,{children:[(0,V.jsx)(B.Z,{md:3,children:(0,V.jsx)(O.Z,{style:{textAlign:"right"},for:"lblPropertyName",children:"Friday:"})}),!0===I(A,4,3)?(0,V.jsxs)(V.Fragment,{children:["       ",(0,V.jsx)(B.Z,{md:9,children:(0,V.jsx)(O.Z,{for:"lblPropertyName",children:"We're Closed "})})]}):(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(B.Z,{md:9,children:(0,V.jsxs)(O.Z,{for:"lblPropertyName",children:[" ",I(A,4,1)," - ",I(A,4,2)," "]})})})]}),(0,V.jsxs)(oe.Z,{children:[(0,V.jsx)(B.Z,{md:3,children:(0,V.jsx)(O.Z,{style:{textAlign:"right"},for:"lblPropertyName",children:"Saturday:"})}),!0===I(A,5,3)?(0,V.jsxs)(V.Fragment,{children:["       ",(0,V.jsx)(B.Z,{md:9,children:(0,V.jsx)(O.Z,{for:"lblPropertyName",children:"We're Closed "})})]}):(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(B.Z,{md:9,children:(0,V.jsxs)(O.Z,{for:"lblPropertyName",children:[" ",I(A,5,1)," - ",I(A,5,2)," "]})})})]}),(0,V.jsxs)(oe.Z,{children:[(0,V.jsx)(B.Z,{md:3,children:(0,V.jsx)(O.Z,{style:{textAlign:"right"},for:"lblPropertyName",children:"Sunday:"})}),1==I(A,6,3)?(0,V.jsxs)(V.Fragment,{children:["       ",(0,V.jsx)(B.Z,{md:9,children:(0,V.jsx)(O.Z,{for:"lblPropertyName",children:"We're Closed "})})]}):(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(B.Z,{md:9,children:(0,V.jsxs)(O.Z,{for:"lblPropertyName",children:[" ",I(A,6,1)," - ",I(A,6,2)," "]})})})]})]}):(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(oe.Z,{children:S?null:(0,V.jsx)(B.Z,{children:" Login and complete business registration! "})})})})}),(0,V.jsxs)(oe.Z,{style:{width:"100%",marginTop:"20px"},children:[2===parseInt(c)&&void 0!==p&&void 0!==p.property&&o.id===p.property.id?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{color:"success",block:!0,onClick:function(){return n.showFlyerUpload=!0,n.showBusinessInfo=!1,void s((0,X.el)())},children:"Upload Flyer"})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{color:"success",block:!0,onClick:function(){a.push("/business-profile?id="+o.id)},children:"Edit"})})]}):f?(0,V.jsx)(B.Z,{children:"1"===o.connected?(0,V.jsx)(R.Z,{color:"success",block:!0,onClick:function(){return function(){var e={merchant_property_id:o.id};s((0,k.Ti)(e)).then((function(e){console.log("disconnect .."+JSON.stringify(e)),n.showBusinessInfo=!1;var r=n.fncCallback;s((0,X.el)()),null!==r&&(console.log("..should trigger call back"),r())})).catch((function(e){}))}()},children:"DisConnect"}):(0,V.jsx)(R.Z,{color:"success",block:!0,onClick:function(){return function(){if(null!==p&&void 0!==p){var e={merchant_property_id:o.id};s((0,k.v_)(e)).then((function(e){n.showBusinessInfo=!1,s((0,X.el)());var r=n.fncCallback;null!==r&&(console.log("..should trigger call back"),r())})).catch((function(e){console.log("...save connection error")}))}else n.connectToMerchantId=o.id,console.log("..start to connect to merchant.."+o.id),s((0,L.ZF)({address:{postalCode:"",streetNumber:"",route:"",locality:"",city:"",country:""},active:!0}))}()},children:"Connect"})}):null,(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{className:"mt-1 mb-5",color:"danger",block:!0,onClick:function(){n.showBusinessInfo=!1,s((0,X.el)())},children:"Cancel"})})]})]})})},Fe=s(99036),Be=s(16616),Me=s(33857),Ae=(s(18706),function(){var e=(0,t.useSelector)((function(e){return e.utilsData})),n=(0,t.useDispatch)(),s=e.selectedProperty,l=(0,t.useSelector)((function(e){return e.auth.me})),o=(0,i.useState)([]),a=(0,r.Z)(o,2),c=a[0],d=a[1],u=(0,i.useState)(!0),h=(0,r.Z)(u,2),m=(h[0],h[1]),p=(0,i.useState)(!1),g=(0,r.Z)(p,2),x=g[0],f=g[1];(0,i.useEffect)((function(){m(!0);var e=s.email;return e=e.replace(s.unit_no+"-",""),console.log("..email is.."+e),n((0,k.Pl)(e)).then((function(e){var n=e.value.value;d(n),m(!1)})),function(){}}),[n]);var j=function(e){console.log("..delete.."+e),n((0,k.$g)(l.id,e)).then((function(e){console.log("..remove high rise binding..",e);var r=s.email;r=r.replace(s.unit_no+"-",""),console.log("..email is.."+r),n((0,k.Pl)(r)).then((function(e){var n=e.value.value;d(n),m(!1),f(!0)}))}))},Z=[{Header:"Del",accessor:"userPropertyId",width:60,Cell:function(e){return(0,V.jsx)(V.Fragment,{children:(0,V.jsx)("img",{src:"/images/buttons/delete.png",style:{marginLeft:"20px"},onClick:function(n){return s=e.value,console.log("...onClickDeleteContact..."+s),void re.Rt.confirm("Are you sure you want to delete your this record? This action is irreversible!",{onOk:function(){return j(s)}});var s}})})}},{accessor:"binding_unit_num",Header:"Unit #",width:80},{accessor:"binding_name",Header:"Name",minWidth:140},{accessor:"binding_email",Header:"Email",minWidth:200},{accessor:"binding_phone",Header:"Phone",minWidth:120},{accessor:"binding_others",Header:"Others"}];return(0,V.jsxs)(B.Z,{md:7,sm:24,xs:12,className:"overlay-form-container-left",children:[(0,V.jsx)(T.rU,{to:"/",children:(0,V.jsx)("img",{className:"logo-container",src:"/assets/img/logo-white.png",alt:"logo"})}),(0,V.jsx)(oe.Z,{style:{marginLeft:"15px",marginRight:"15px"},children:(0,V.jsxs)(B.Z,{className:"highRise_table",style:{textAlign:"left"},children:[(0,V.jsxs)("h5",{children:[" \xa0\xa0\xa0 ",s.street_number+" "+s.route+" , "+s.locality," "]}),(0,V.jsx)(Me.Z,{data:c,columns:Z,defaultPageSize:10,className:"-striped -highlight"})]})}),(0,V.jsx)(oe.Z,{children:(0,V.jsx)(B.Z,{style:{textAlign:"center"},children:(0,V.jsx)(R.Z,{className:"mt-1 mb-5",color:"danger",block:!0,onClick:function(){e.showHighRiseInfo=!1,n((0,X.xd)()),x&&location.reload()},children:"Cancel"})})})]})}),_e=function(){var e=(0,t.useSelector)((function(e){return e.utilsData})),n=(0,t.useDispatch)(),s=e.properties,l=(0,t.useSelector)((function(e){return e.auth.me})),o=(0,i.useState)([]),a=(0,r.Z)(o,2),c=a[0],d=a[1],u=(0,i.useState)(!0),h=(0,r.Z)(u,2),m=(h[0],h[1]),p=(0,i.useState)(!1),g=(0,r.Z)(p,2),x=g[0],f=g[1];(0,i.useEffect)((function(){m(!1);var e=[];return s.map((function(n){1===n.properties.no_delivery&&e.push(n.properties)})),console.log("..",e),d(e),function(){}}),[n]);var j=function(e,r){console.log("..row",r),n((0,k.fh)(e,l.id,r.original.userPropertiesId)).then((function(n){console.log("..remove high rise binding..",n);var r=[];s.map((function(n){1===n.properties.no_delivery&&n.properties.user_id!==e&&r.push(n.properties)})),console.log("..",r),d(r),f(!0)}))},Z=[{Header:"Operate",accessor:"user_id",Cell:function(e){return(0,V.jsx)(V.Fragment,{children:(0,V.jsx)("img",{src:"/images/buttons/delete.png",onClick:function(n){return function(e,n,s){re.Rt.confirm("Are you sure you want to delete your this record? This action is irreversible!",{onOk:function(){return j(n,s)}})}(0,e.value,e)}})})}},{accessor:"bindingName",Header:"Name"},{accessor:"bindingEmail",Header:"Email"},{accessor:"bindingPhone",Header:"Phone"}];return(0,V.jsxs)(B.Z,{md:4,sm:12,xs:12,className:"overlay-form-container-left",children:[(0,V.jsx)(T.rU,{to:"/",children:(0,V.jsx)("img",{className:"logo-container",src:"/assets/img/logo-white.png",alt:"logo"})}),(0,V.jsx)(oe.Z,{children:(0,V.jsxs)(B.Z,{style:{textAlign:"left"},children:[(0,V.jsx)("h5",{children:" No Delivery User Information "}),(0,V.jsx)(Me.Z,{data:c,columns:Z,defaultPageSize:10,className:"-striped -highlight"})]})}),(0,V.jsx)(oe.Z,{children:(0,V.jsx)(B.Z,{style:{textAlign:"center"},children:(0,V.jsx)(R.Z,{className:"mt-1 mb-5",color:"danger",block:!0,onClick:function(){e.showNoDelivery=!1,n((0,X.x_)()),x&&location.reload()},children:"Cancel"})})})]})},Ee=function(e){e.callback;var n=(0,t.useSelector)((function(e){return e.utilsData})),s=(0,t.useDispatch)(),o=((0,l.k6)(),(0,i.useState)([])),a=(0,r.Z)(o,2),c=a[0],d=a[1],u=(0,M.TA)({initialValues:{restaurant:!1,groceries:!1,cannibus:!1},isInitialValid:!1,onSubmit:function(){var e=(0,p.Z)((0,m.Z)().mark((function e(r,i){var t,l,o,a,d,u,h;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=i.setSubmitting)(!0),console.log("...submit..",r),l=c.find((function(e){return"restaurant"===e.attributes.preference})),o=l?{id:l.id,data:{users_id:v.id,preference:"restaurant",selected:r.restaurant}}:{data:{users_id:v.id,preference:"restaurant",selected:r.restaurant}},e.next=7,s((0,k.IW)(o));case 7:return e.sent,a=c.find((function(e){return"groceries"===e.attributes.preference})),d=a?{id:a.id,data:{users_id:v.id,preference:"groceries",selected:r.groceries}}:{data:{users_id:v.id,preference:"groceries",selected:r.groceries}},e.next=12,s((0,k.IW)(d));case 12:return e.sent,u=c.find((function(e){return"cannibus"===e.attributes.preference})),h=u?{id:u.id,data:{users_id:v.id,preference:"cannibus",selected:r.cannibus}}:{data:{users_id:v.id,preference:"cannibus",selected:r.cannibus}},e.next=17,s((0,k.IW)(h));case 17:e.sent,t(!1),n.showPreference=!1,s((0,X.qe)());case 21:case"end":return e.stop()}}),e)})));return function(n,s){return e.apply(this,arguments)}}()}),h=(u.handleChange,u.handleBlur),g=u.handleSubmit,x=u.errors,f=u.touched,j=u.isValid,Z=u.isSubmitting,b=u.setFieldValue,y=u.values,v=(0,t.useSelector)((function(e){return e.auth.me}));return(0,i.useEffect)((function(){s((0,k._s)(v.id)).then((function(e){console.log("...user preference..",e),e.value.data.map((function(e){"restaurant"===e.attributes.preference&&b("restaurant",e.attributes.selected),"groceries"===e.attributes.preference&&b("groceries",e.attributes.selected),"cannibus"===e.attributes.preference&&b("cannibus",e.attributes.selected)})),d(e.value.data)}))}),[s]),(0,V.jsxs)(B.Z,{md:3,sm:12,xs:12,className:"overlay-form-container",children:[(0,V.jsx)(T.rU,{to:"/",children:(0,V.jsx)("img",{className:"logo-container",src:"/assets/img/logo-white.png",alt:"logo"})}),(0,V.jsxs)(A.Z,{onSubmit:g,children:[(0,V.jsx)(oe.Z,{style:{width:"100%",paddingLeft:"10px"},children:(0,V.jsx)(B.Z,{style:{textAlign:"left"},children:(0,V.jsxs)(E.Z,{tag:"fieldset",children:["I agree to receive coupon, flyer, and promoting events from the following companies. You can withdraw your consent at any time",(0,V.jsx)(E.Z,{check:!0,children:(0,V.jsxs)(O.Z,{check:!0,children:[(0,V.jsx)(_.Z,{type:"checkbox",name:"restaurant",onChange:function(e){b("restaurant",e.currentTarget.checked)},checked:y.restaurant,onBlur:h,invalid:f.restaurant&&x.restaurant}),"Restaurant"]})}),(0,V.jsx)(E.Z,{check:!0,children:(0,V.jsxs)(O.Z,{check:!0,children:[(0,V.jsx)(_.Z,{type:"checkbox",name:"cannibus",onChange:function(e){b("cannibus",e.currentTarget.checked)},checked:y.cannibus,onBlur:h,invalid:f.cannibus&&x.cannibus}),"Cannibus"]})}),(0,V.jsx)(E.Z,{check:!0,children:(0,V.jsxs)(O.Z,{check:!0,children:[(0,V.jsx)(_.Z,{type:"checkbox",name:"groceries",onChange:function(e){b("groceries",e.currentTarget.checked)},checked:y.groceries,onBlur:h,invalid:f.groceries&&x.groceries}),"Groceries"]})})]})})}),(0,V.jsxs)(oe.Z,{children:[(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{block:!0,disabled:!j||Z,children:Z?(0,V.jsx)(U.Z,{size:"sm"}):"Confirm"})}),(0,V.jsx)(B.Z,{children:(0,V.jsx)(R.Z,{className:"mt-1 mb-5",color:"danger",block:!0,onClick:function(){n.showPreference=!1,s((0,X.qe)())},children:"Cancel"})})]})]})]})},Oe=s(47569),De=z.Ry().shape({description:z.Z_().required("full name is required")}),Re=function(e){e.callback;var n=(0,t.useSelector)((function(e){return e.utilsData}));console.log("...utilsData.."+JSON.stringify(n));var s=(0,t.useDispatch)(),o=((0,l.k6)(),(0,i.useState)("default")),a=(0,r.Z)(o,2),c=(a[0],a[1],(0,t.useSelector)((function(e){return e.auth.me}))),d=(0,t.useSelector)((function(e){return e.admin.uploadedFiles})),u="https://klosertoyou.com/business-portal/"+n.selectedProperty.id,h=(0,M.TA)({initialValues:{id:0,description:"",uploadedFiles:[]},validationSchema:De,onSubmit:function(e,r){var i=r.setSubmitting;i(!0),console.log("..uploadedFiles..",d);var t={ownerId:c.id,description:e.description,uploadedFiles:d};s((0,k.UW)(t)).then((function(){console.log("...flyer upload DONE.."),n.showFlyerUpload=!1,s((0,X.b)()),setTimeout(window.location.replace(u),500)})).catch((function(){return i(!1)}))}}),m=h.handleChange,p=h.handleBlur,g=h.handleSubmit,x=h.errors,f=h.touched,j=h.values,Z=h.isValid,b=h.isSubmitting;h.resetForm,h.setValues,h.setFieldValue,h.setFieldTouched;return(0,V.jsxs)(B.Z,{md:6,sm:12,xs:12,className:"overlay-form-container",children:[(0,V.jsx)(T.rU,{to:"/",children:(0,V.jsx)("img",{className:"logo-container",src:"/assets/img/logo-white.png",alt:"logo"})}),(0,V.jsx)(oe.Z,{style:{width:"80%",paddingLeft:"70px"},children:(0,V.jsx)(B.Z,{style:{textAlign:"left"},children:(0,V.jsxs)(xe.lx,{onSubmit:g,children:[(0,V.jsxs)(oe.Z,{children:[(0,V.jsx)(xe.b7,{xs:"12",children:(0,V.jsxs)(xe.We,{children:[(0,V.jsx)(xe.cc,{htmlFor:"description",children:"Flyer Description"}),(0,V.jsx)(xe.C$,{id:"description",name:"description",onChange:m,onBlur:p,value:j.description,invalid:f.description&&x.description}),(0,V.jsx)(xe.ev,{children:x.description})]})}),(0,V.jsxs)(xe.b7,{xs:"12",children:[(0,V.jsx)("hr",{}),"Upload Flyers:",(0,V.jsx)(Oe.Z,{extension:"application/pdf"})]})]}),(0,V.jsxs)(oe.Z,{children:[(0,V.jsxs)(xe.b7,{xs:"6",children:[(0,V.jsx)(xe.u5,{disabled:!Z||b,type:"submit",color:"primary",children:b?(0,V.jsx)(xe.LQ,{size:"sm"}):"Submit"})," "]}),(0,V.jsx)(xe.b7,{xs:"6",children:(0,V.jsx)(xe.u5,{className:"mt-1 mb-5",color:"danger",block:!0,onClick:function(){n.showFlyerUpload=!1,s((0,X.b)())},children:"Cancel"})})]})]})})})]})},Ue=function(e){e.callback;var n=(0,t.useSelector)((function(e){return e.utilsData}));console.log("...utilsData.."+JSON.stringify(n));var s=(0,t.useDispatch)(),o=((0,l.k6)(),(0,i.useState)("default")),a=(0,r.Z)(o,2),c=(a[0],a[1],(0,t.useSelector)((function(e){return e.auth.me})),(0,t.useSelector)((function(e){return e.admin.uploadedFiles}))),d=(0,M.TA)({initialValues:{uploadedFiles:[]},onSubmit:function(e,r){var i=r.setSubmitting;i(!0),console.log("..uploadedFiles..",e);var t={fileName:c[0].url};console.log("..data..",t),s((0,k.WN)(t)).then((function(){i(!1),console.log("...flyer upload DONE.."),n.showImportCustomer=!1,s((0,X.b)()),re.Rt.success("Success","Import Customer Sucess!"),setTimeout(window.location.reload(),500)})).catch((function(){return i(!1)}))}}),u=(d.handleChange,d.handleBlur,d.handleSubmit),h=d.errors,m=(d.touched,d.values,d.isValid),p=d.isSubmitting;d.resetForm,d.setValues,d.setFieldValue,d.setFieldTouched;return(0,V.jsxs)(B.Z,{md:6,sm:12,xs:12,className:"overlay-form-container",children:[(0,V.jsx)(T.rU,{to:"/",children:(0,V.jsx)("img",{className:"logo-container",src:"/assets/img/logo-white.png",alt:"logo"})}),(0,V.jsx)(oe.Z,{style:{width:"80%",paddingLeft:"70px"},children:(0,V.jsx)(B.Z,{style:{textAlign:"left"},children:(0,V.jsxs)(xe.lx,{onSubmit:u,children:[(0,V.jsxs)(oe.Z,{children:[(0,V.jsx)(xe.b7,{xs:"12",children:(0,V.jsxs)(xe.We,{children:[(0,V.jsxs)(xe.cc,{htmlFor:"description",children:["Note: Please verify your Excel file is the same as \xa0",(0,V.jsx)("a",{href:"https://rest.klosertoyou.com/uploads/CUSTOMERLIST_e4faa6ac71.xlsx",children:"this template"})]}),(0,V.jsx)(xe.ev,{children:h.description})]})}),(0,V.jsxs)(xe.b7,{xs:"12",children:[(0,V.jsx)("hr",{}),"Upload Excel File:",(0,V.jsx)(Oe.Z,{extension:".xlsx"})]})]}),(0,V.jsxs)(oe.Z,{children:[(0,V.jsxs)(xe.b7,{xs:"6",children:[(0,V.jsx)(xe.u5,{disabled:!m||p,type:"submit",color:"primary",children:p?(0,V.jsx)(xe.LQ,{size:"sm"}):"Submit"})," "]}),(0,V.jsx)(xe.b7,{xs:"6",children:(0,V.jsx)(xe.u5,{className:"mt-1 mb-5",color:"danger",block:!0,onClick:function(){n.showImportCustomer=!1,s((0,X.b)())},children:"Cancel"})})]})]})})})]})};y().accessToken="pk.eyJ1IjoieWt1cnNhdCIsImEiOiJjam9rMmFrZGkwMmpjM3F0b3huZ2hkM2VnIn0.tuCDaZM6aIA2KQZbtucKpQ";var ze=function(e){(0,j.Z)(s,e);var n=(0,Z.Z)(s);function s(){var e;(0,g.Z)(this,s);for(var r=arguments.length,i=new Array(r),t=0;t<r;t++)i[t]=arguments[t];return(e=n.call.apply(n,[this].concat(i))).state={pins:[],mapInitialized:!1,searchText:"",selectedAddress:null,email:"",properties:[],changeColor:!1,layerAdded:[],draw:null,drawedBefore:!1,drawing:!1,selectedProperties:[],feature:null,selectedPropertyEmail:[],satelliteMode:!1,showMapLegend:!1,showBusinessInfo:!1,propertyByTpe:null,has2Address:!0,hasBusinessProfile:!0},e.renderPropertiesTooltip=function(n){var s=n.id,r=n.email,i=n.property,t=e.props.utilsData,l=e.state.properties,o=e.props.auth.user;if(console.log("...renderPropertiesTooltip..",i),i.usuage&&2===(0,Fe.Z)(i.usuage)){t.selectedProperty=i,t.showBusinessInfo=!0,t.fncCallback=e.cbBusinessInfoCallBack;var a=(0,w.getLoginType)();if(2===(0,Fe.Z)(a)){var c=0;l.map((function(e){1===e.properties.no_delivery&&c++})),c>0?(t.properties=l,t.showBusinessInfo=!0,t.showNoDelivery=!0,e.setState({showBusinessInfo:!0})):e.setState({showBusinessInfo:!0})}else e.setState({showBusinessInfo:!0})}else{if(3!==(0,Fe.Z)(i.usuage)&&1!==(0,Fe.Z)(i.usuage)||"highRise"!==i.settlement_type||!i.unit_no)return(0,V.jsx)(P.Z,{email:r,id:s,property:i,cb:e.removeProperty,changeColor:e.changeColor,editMode:t.editMode,cbBinding:e.bindingProperty,cbSendEmail:e.cbSendEmail,cbBusiness:e.cbBusiness,user:o,cbBusinessInfo:e.cbBusinessInfo});t.selectedProperty=i,t.showHighRiseInfo=!0,t.fncCallback=e.cbBusinessInfoCallBack,e.setState({showBusinessInfo:!0})}},e.cbSendEmail=function(n,s){var r=e.props.utilsData;r.drawFinished=!0;var i=[];i.push({properties:s}),r.selectedProperty=i,e.setState({selectedProperties:i})},e.changeColor=function(){var n=(0,p.Z)((0,m.Z)().mark((function n(s){var r;return(0,m.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(r=e.props.utilsData).changeColor=!0,r.emailForChangeColor=s,console.log("....setting utilsData.changeColor....."+s),e.setState({changeColor:!0});case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.cbBusiness=function(){var n=(0,p.Z)((0,m.Z)().mark((function n(s,r){return(0,m.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.props.history.push("/business-profile?id="+r.id);case 2:case"end":return n.stop()}}),n)})));return function(e,s){return n.apply(this,arguments)}}(),e.cbBusinessInfo=function(){var n=(0,p.Z)((0,m.Z)().mark((function n(s,r){var i;return(0,m.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=e.props.utilsData,e.props.auth,i.selectedProperty=r,i.showBusinessInfo=!0,i.fncCallback=e.cbBusinessInfoCallBack,e.setState({showBusinessInfo:!0});case 6:case"end":return n.stop()}}),n)})));return function(e,s){return n.apply(this,arguments)}}(),e.cbBusinessInfoCallBack=function(){console.log("...call back function works..."),e.redrawMap()},e.bindingProperty=function(){var n=(0,p.Z)((0,m.Z)().mark((function n(s,r){var i;return(0,m.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=e.props.utilsData,r&&r.is_business&&(1===r.is_business||!0===r.is_business)?(i.selectedProperty=r,i.showBusinessInfo=!0,i.fncCallback=e.cbBusinessInfoCallBack,e.setState({showBusinessInfo:!0})):(console.log("..binding property.."+JSON.stringify(r)),i.bindingProperty=!0,i.emailForChangeColor=s,i.selectedProperty=r,i.fncCallback=e.cbBusinessInfoCallBack,console.log("....setting utilsData.bindingProperty....."+s),e.setState({bindingProperty:!0}));case 2:case"end":return n.stop()}}),n)})));return function(e,s){return n.apply(this,arguments)}}(),e.bindingBusiness=function(e){},e.redrawMap=(0,p.Z)((0,m.Z)().mark((function n(){var s,r,i,t,l,o,a,c,d,u,h;return(0,m.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(s=e.context.map)&&((0,C.MB)(s),(0,C.if)(s),(0,C.Yh)(s),s.removeLayer("area"),s.removeSource("area")),r=new(pe())({controls:{point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1}}),i=e.props.loadConnected,n.next=6,i();case 6:t=n.sent,l=t.value,o=(0,w.convertLocation)(l.value);try{if(e.state.pins.map((function(e){e.marker.remove()})),e.setState({properties:o.map((function(e){return{type:"Feature",properties:e,geometry:{type:"Point",coordinates:[e.location.longitude,e.location.latitude]}}})),draw:r}),s.addSource("area",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),s.addLayer({id:"area",type:"fill",source:"area",layout:{},paint:{"fill-color":"#088","fill-opacity":.8}}),(a=document.getElementsByClassName("mapboxgl-popup")).length)for(c=a.length,d=c-1;d>=0;d--){console.log("...remove popup box i= .."+d);try{a[d]&&a[d].remove()}catch(m){console.log("..remove popup error..")}}u=e.props.auth,null!==(h=u.user)&&void 0!==h?((0,C.gU)(s,o,e.renderPropertiesTooltip,!1),(0,C.Q7)(s,o,h),(0,C.vM)(s,o,h)):(0,C.gU)(s,o,e.renderPropertiesTooltip,!1)}catch(p){}case 10:case"end":return n.stop()}}),n)}))),e.changeColorCallack=function(){var n=(0,p.Z)((0,m.Z)().mark((function n(s,r,i){var t,l,o,a,c,d,p,g;return(0,m.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:s?e.redrawMap():(t=e.state.pins,l=t.filter((function(e){return e.email.split("@")[0]===i.split("@")[0]})),o=t.filter((function(e){return e.email.split("@")[0]!==i.split("@")[0]})),console.log("..others pin.."+o.length+"..current pin.."+l.length+" email="+i+" color="+r),l&&l.length>0&&(a=e.context.map,l[0].marker.remove(),c=document.createElement("div"),48,48,c.className="marker",d="map-markers/blue_home_pin.png","default"===r&&(d="/map-markers/blue_home_pin.png"),"hasInjured"===r&&(d="/map-markers/red_home_pin.png"),"pending"===r&&(d="/map-markers/grey_home_pin.png"),"safe"===r&&(d="/map-markers/green_home_pin.png"),"secondary"===r&&(d="/map-markers/second_home_pin.png"),console.log("..change color.."+d),c.style.backgroundImage="url("+d+")",c.style.width="".concat(48,"px"),c.style.height="".concat(48,"px"),c.style.backgroundSize="100%",(p=new(y().Marker)(c).setPopup(new(y().Popup)({closeOnClick:!0,closeButton:!0,maxWidth:"none"}).setHTML("<h1>No address</h1>"))).setLngLat([l[0].geocodeData.longitude,l[0].geocodeData.latitude]),p.addTo(a),g=document.createElement("div"),ae.render((0,V.jsxs)("div",{className:"info-window",children:[(0,V.jsx)("h4",{children:i}),(0,V.jsx)(oe.Z,{className:"justify-content-end ",children:(0,V.jsx)(B.Z,{className:"list-unstyled text-right",children:(0,V.jsxs)("li",{children:[(0,V.jsx)(R.Z,{size:"sm",onClick:function(){return e.bindingProperty(i)},children:"Info"})," \xa0\xa0\xa0\xa0",(0,V.jsx)(R.Z,{size:"sm",onClick:function(){return e.addAddress(3)},children:"Add"})," \xa0\xa0\xa0\xa0",(0,V.jsx)(R.Z,{size:"sm",onClick:function(){return e.removeAddress(i)},children:"Remove"})," \xa0\xa0\xa0\xa0"]})})})]}),g),p.getPopup().setDOMContent(g),e.setState((function(e){return(0,h.Z)((0,h.Z)({},e),{},{pins:[].concat((0,u.Z)(o),[{marker:p,email:l[0].email,geocodeData:l[0].geocodeData,color:r}])})}))));case 1:case"end":return n.stop()}}),n)})));return function(e,s,r){return n.apply(this,arguments)}}(),e.removeProperty=function(){var n=(0,p.Z)((0,m.Z)().mark((function n(s,r){var i,t,l,o,a,c,d,u,h,p,g,x;return(0,m.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("..remove this property.."+s),i=s.split("@")[0],t=e.state.properties,l=t.filter((function(e){return e.properties.email.split("@")[0]!==i})),o=t.filter((function(e){return e.properties.email.split("@")[0]===i})),!r){n.next=9;break}return e.props.history.push("/edit-property"),n.abrupt("return");case 9:if(a=e.props.deleteUserAdditionalAddressById,e.props.utilsData,!(o&&o.length>0)){n.next=16;break}return n.next=14,a(o[0].properties.id);case 14:n.sent,"grey"!==o[0].properties.color&&Be.Z.$dispatch("onTotalConnectChange",{totalConnected:-1});case 16:c=e.context.map;try{if((d=document.getElementsByClassName("mapboxgl-popup")).length)for(u=d.length,h=u-1;h>=0;h--){console.log("...remove popup box i= .."+h);try{d[h]&&d[h].remove()}catch(m){console.log("..remove popup error..")}}c&&((0,C.MB)(c),(0,C.if)(c),(0,C.Yh)(c)),e.setState({properties:l}),p=(0,w.convertGeoProperty)(l),g=e.props.auth,x=g.user,(0,C.gU)(c,p,e.renderPropertiesTooltip,!1),(0,C.Q7)(c,p,x),(0,C.vM)(c,p,x)}catch(f){console.log("...remove property error..."+JSON.stringify(f))}case 18:case"end":return n.stop()}}),n)})));return function(e,s){return n.apply(this,arguments)}}(),e.onClickMap=function(n){var s=n.lngLat,r=s.lng,i=s.lat,t=e.props,l=t.utilsData,o=t.auth.user;l.editMode?(console.log("..in edit mode.."),e.createMarker({latitude:i,longitude:r})):null===o||void 0==o?e.createMarker({latitude:i,longitude:r}):console.log(".. editMode turn off..")},e.createMarker=function(){var n=(0,p.Z)((0,m.Z)().mark((function n(s){var r,i,t,l,o,a,c,d,p,g,x,f,j,Z,b;return(0,m.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=s.latitude,i=s.longitude,t=e.context.map,l=(0,w.getLoginType)(),o=e.state.has2Address,a="Add",c=3,o||(1===(0,Fe.Z)(l)?(a="Add Home Address",c=1):(a="Add Business Address",c=2)),d=document.createElement("div"),48,48,d.className="marker",d.style.backgroundImage="url(https://klosertoyou.com/map-markers/blue_home_pin.png)",d.style.width="".concat(48,"px"),d.style.height="".concat(48,"px"),d.style.backgroundSize="100%",(p=new(y().Marker)(d).setPopup(new(y().Popup)({closeOnClick:!0,closeButton:!0,maxWidth:"none"}).setHTML("<h1>No address</h1>"))).setLngLat([i,r]),p.addTo(t),p.on("dragend",e.onDragMarker),p.on("click",(function(){return p.togglePopup()})),n.next=22,(0,S.bu)({longitude:i,latitude:r});case 22:g=n.sent,void 0!==(x=localStorage.getItem("current_domain"))&&null!==x||(x="alphc.com"),f=(0,S.Jk)(g)+"@"+x,e.setState({selectedAddress:g,email:f}),j=e.props.auth,Z=document.createElement("div"),null!==j.user&&void 0!==j.user?ae.render((0,V.jsxs)("div",{className:"info-window",children:[(0,V.jsx)("h4",{children:f}),(0,V.jsx)(oe.Z,{className:"justify-content-end ",children:(0,V.jsx)(B.Z,{className:"list-unstyled text-right",children:(0,V.jsxs)("li",{children:[(0,V.jsx)(R.Z,{size:"sm",onClick:function(){return e.addAddress(c)},children:a})," \xa0\xa0\xa0\xa0",(0,V.jsx)(R.Z,{size:"sm",onClick:function(){return e.removeAddress(f)},children:"Remove"})," \xa0\xa0\xa0\xa0"]})})})]}),Z):ae.render((0,V.jsxs)("div",{className:"info-window",children:[(0,V.jsx)("h4",{children:f}),(0,V.jsx)(oe.Z,{className:"justify-content-end ",children:(0,V.jsx)(B.Z,{className:"list-unstyled text-right",children:(0,V.jsx)("li",{children:(0,V.jsx)(R.Z,{size:"sm",onClick:function(){return e.activateAddress()},children:"Activate this address"})})})})]}),Z),p.getPopup().setDOMContent(Z),p.togglePopup(),b=e.state.pins,null!==j.user&&void 0!==j.user?(b.forEach((function(e){e.marker.getPopup().isOpen()&&e.marker.togglePopup()})),e.setState((function(e){return(0,h.Z)((0,h.Z)({},e),{},{pins:[].concat((0,u.Z)(b),[{marker:p,email:f,geocodeData:g,color:"default"}])})}))):(b.forEach((function(e){e.marker.getPopup().isOpen()&&e.marker.togglePopup(),e.marker.remove()})),e.setState((function(e){return(0,h.Z)((0,h.Z)({},e),{},{pins:[{marker:p,email:f,geocodeData:g}]})})));case 34:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.removeAddress=function(n){var s=e.state.pins;s.filter((function(e){return e.email===n}))[0].marker.remove();var r=s.filter((function(e){return e.email!==n}));e.setState((function(e){return(0,h.Z)((0,h.Z)({},e),{},{pins:r})}));var i=e.state.layerAdded.filter((function(e){return e.email===n})),t=e.context.map;i&&i.length>0&&(0,C.cu)(t,i[0].layerId)},e.addUnitNumber=function(n){var s=prompt("Please enter unit number","");if(s){var r=e.state,i=r.selectedAddress,t=(r.properties,r.pins),l=t.filter((function(e){return e.email===n}));console.log("..selectedAddress.."+JSON.stringify(i)),i.unitNo=s;var o=(0,S.Jk)(i);console.log("..emailDisplay.."+o),i.email=o,l[0].email=o,e.setState({selectedAddress:i,pins:t})}},e.addAddress=function(n){var s=e.state,r=s.selectedAddress,i=s.email,t=s.properties,l=s.pins,o=s.layerAdded,a=s.has2Address,c=e.context.map,d=e.props.utilsData,u=(0,w.getLoginType)(),g=l.filter((function(e){return e.email===i})),x={item:(0,h.Z)((0,h.Z)({email:i,usuage:n},r),{},{color:a?"grey":1===(0,Fe.Z)(u)?"default":"red"})},f={type:"Feature",properties:(0,h.Z)((0,h.Z)({email:i},r),{},{color:g[0].color}),geometry:{type:"Point",coordinates:[r.location.longitude,r.location.latitude]}},j=e.props,Z=j.saveBatchProperties,b=j.getMe;t.push(f),Z(x).then(function(){var n=(0,p.Z)((0,m.Z)().mark((function n(s){var l,h,p,x,f;return(0,m.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:g&&(l=document.createElement("div"),ae.render((0,V.jsxs)("div",{className:"info-window",children:[(0,V.jsx)("h4",{children:i}),(0,V.jsx)(oe.Z,{className:"justify-content-end ",children:(0,V.jsx)(B.Z,{className:"list-unstyled text-right",children:(0,V.jsxs)("li",{children:[(0,V.jsx)(R.Z,{size:"sm",onClick:function(){return e.bindingProperty(i)},children:"Info"}),"\xa0\xa0\xa0\xa0",(0,V.jsx)(R.Z,{size:"sm",onClick:function(){return e.removeAddress(i)},children:"Remove"})," \xa0\xa0\xa0\xa0"]})})})]}),l),g[0].marker.getPopup().setDOMContent(l),g[0].marker.getPopup().isOpen()&&g[0].marker.togglePopup()),h=t.filter((function(e){return!0===e.properties.primaryAddress})),(p=[]).push(r),x=(0,w.generateString)(10),f={email:i,layerId:x},o.push(f),e.setState({layerAdded:o,properties:t}),h&&h.length>0&&(0,C.ax)(c,ce.kM.user.injured,x,p,(function(e){return[[h[0].properties.location.longitude,h[0].properties.location.latitude],[e.location.longitude,e.location.latitude]]})),console.log("..binding property.."+JSON.stringify(r)),d.bindingProperty=!0,d.emailForChangeColor=i,d.selectedProperty=r,d.fncCallback=e.cbBusinessInfoCallBack,a?e.setState({bindingProperty:!0}):b(u).then((function(e){location.reload()})).catch((function(e){re.Rt.error("Error","Get information error!")}));case 15:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())},e.activateAddress=function(){var n=e.props,s=n.setPropertyRegistrationForm,r=n.registerForm,i=e.state.selectedAddress;console.log("..selectedAddress.."+JSON.stringify(i));(0,f.Z)(e);r.address=i,s({address:i,active:!0}),e.setState({address:i})},e.onDragMarker=function(){var n=(0,p.Z)((0,m.Z)().mark((function n(s){var r,i,t,l,o,a,c,d,p,g,x;return(0,m.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(r=e.state.pins).forEach((function(e){e.marker.getPopup().isOpen()&&e.marker.togglePopup()})),i=s.target.getLngLat(),t=i.lng,l=i.lat,n.next=5,(0,S.bu)({longitude:t,latitude:l});case 5:o=n.sent,void 0!==(a=localStorage.getItem("current_domain"))&&null!==a||(a="alphc.com"),c=(0,S.Jk)(o)+"@"+a,e.setState({selectedAddress:o,email:c}),d=r.map((function(e){return e.marker===s.target})).indexOf(!0),p=r[d].marker,g=e.props.auth,x=document.createElement("div"),null!==g.user&&void 0!==g.user?ae.render((0,V.jsxs)("div",{className:"info-window",children:[(0,V.jsxs)("h4",{children:[c,"@alphc.com"]}),(0,V.jsx)(oe.Z,{className:"justify-content-end ",children:(0,V.jsx)(B.Z,{className:"list-unstyled text-right",children:(0,V.jsxs)("li",{children:[(0,V.jsx)(R.Z,{size:"sm",onClick:function(){return e.removeAddress(c)},children:"Remove"})," \xa0\xa0\xa0\xa0",(0,V.jsx)(R.Z,{size:"sm",onClick:function(){return e.addAddress(3)},children:"Add"})]})})})]}),x):ae.render((0,V.jsxs)("div",{className:"info-window",children:[(0,V.jsxs)("h4",{children:[c,"@alphc.com"]}),(0,V.jsx)(oe.Z,{className:"justify-content-end ",children:(0,V.jsx)(B.Z,{className:"list-unstyled text-right",children:(0,V.jsx)("li",{children:(0,V.jsx)(R.Z,{size:"sm",onClick:function(){return e.activateAddress()},children:"Activate this address"})})})})]}),x),p.getPopup().setDOMContent(x),p.togglePopup(),e.setState((function(e){return(0,h.Z)((0,h.Z)({},e),{},{pins:[].concat((0,u.Z)(r.slice(0,d)),[{marker:p,email:c}],(0,u.Z)(r.slice(d+1,r.length)))})}));case 18:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.onSubmitSearch=function(n){n.preventDefault();var s=e.state.searchText;s.trim()&&(0,S.gA)({address:s}).then((function(n){var s=e.context.map;n&&(e.createMarker({latitude:n.latitude,longitude:n.longitude}),s.flyTo({center:[n.longitude,n.latitude]}))}))},e.onChangeSearchText=function(n){e.setState({searchText:n.currentTarget.value})},e.toggleSatelliteMode=function(n){var s=e.state.satelliteMode,r=e.context.map;s?r.setStyle("mapbox://styles/mapbox/streets-v12"):r.setStyle("mapbox://styles/mapbox/satellite-streets-v12"),e.setState({satelliteMode:!s}),e.redrawMap()},e.toggleDrawing=function(n){var s=e.state,r=s.drawing,i=s.draw,t=s.selectedProperties,l=(s.feature,s.properties);console.log("...toggleDrawing...");var o=e.context.map,a=e.props.utilsData;if(a.drawing=!r,r){var c=i.getAll();try{o.getSource("area").setData(c)}catch(n){}var d=l.filter((function(e){return(0,ge.Z)(e,c.features[0])})),u=[];t.map((function(e){var n={Email:e.properties.email};u.push(n)})),console.log(" end drawing 1="+JSON.stringify(d)+" 2="+JSON.stringify(u)),a.drawFinished=!0,a.selectedProperty=d,a.fncCallback=e.cbBusinessInfoCallBack,e.setState({drawing:!r,selectedProperties:d,selectedPropertyEmail:u,feature:c.features[0]}),o.removeControl(i)}else try{o.addControl(i,"top-left"),i.changeMode(i.modes.DRAW_POLYGON),o.getSource("area").setData({type:"FeatureCollection",features:[]}),e.setState({drawing:!r,selectedProperties:[],feature:null,selectedPropertyEmail:[]})}catch(n){}},e.toggleShowMapLegend=function(n){var s=e.state.showMapLegend;e.setState({showMapLegend:!s})},e.PropertyMarkerDescriptions=[{marker:ce.kM.property.default,description:"Add your Address Makers based on need and requirements"},{marker:ce.kM.property.hasInjured,description:"Add your Address Makers based on need and requirements"},{marker:ce.kM.property.pending,description:"Add your Address Makers based on need and requirements"},{marker:ce.kM.property.safe,description:"Add your Address Makers based on need and requirements"}],e}return(0,x.Z)(s,[{key:"componentDidUpdate",value:function(e,n,s){var r=this.context.map;!this.state.mapInitialized&&r&&(this.initializeLayers(),this.setState({mapInitialized:!0}))}},{key:"componentWillUnmount",value:function(){var e=this.context.map;try{e&&((0,C.MB)(e),(0,C.if)(e),(0,C.Yh)(e),e.removeLayer("area"),e.removeSource("area"))}catch(n){console.log("..componment unmount error")}}},{key:"initializeLayers",value:function(){var e=(0,p.Z)((0,m.Z)().mark((function e(){var n,s,r,i,t,l,o,a,c,d,u,h,p,g,x,f,j,Z,b,y,v;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.context.map,s=this.props,r=s.loadConnected,i=s.loadBusinessAddress,t=s.getAddressByType,l=s.checkBusinessProfile,o=new(pe())({controls:{point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1}}),a=this.props.auth,c=a.user,d=[],"",null!==c&&void 0!==c){e.next=15;break}return e.next=10,i();case 10:u=e.sent,h=u.value,d=(0,w.convertLocation)(h.propertyInfo),e.next=33;break;case 15:return e.next=17,r();case 17:return p=e.sent,g=p.value,d=(0,w.convertLocation)(g.value),x=(0,w.getLoginType)(),e.next=23,t(x);case 23:if(f=e.sent,(j=f.value).value&&j.value.length>0||(this.setState({has2Address:!1}),Z="Please switch to Edit Mode and add your Business Address",1===(0,Fe.Z)(x)&&(Z="Please enter and register home address"),re.Rt.info("Tips",Z)),2!==(0,Fe.Z)(x)){e.next=33;break}return e.next=29,l();case 29:b=e.sent,y=b.value,console.log("..hasBusinessProfile.."+JSON.stringify(y)),0===(0,Fe.Z)(y.value[0].profileTotal)&&(re.Rt.info("Tips","Please setup your business profile!"),j.value&&j.value.length>0?location.href="/business-profile?id="+j.value[0].id:console.log("..me is .."+JSON.stringify(c)));case 33:try{this.setState({properties:d.map((function(e){return{type:"Feature",properties:e,geometry:{type:"Point",coordinates:[e.location.longitude,e.location.latitude]}}})),draw:o}),n.addSource("area",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),n.addLayer({id:"area",type:"fill",source:"area",layout:{},paint:{"fill-color":"#088","fill-opacity":.8}}),null===c||void 0===c?(0,C.gU)(n,d,this.renderPropertiesTooltip,!0):((0,C.gU)(n,d,this.renderPropertiesTooltip,!0),(0,C.Q7)(n,d,c),(0,C.vM)(n,d,c)),(v=localStorage.getItem("show_login_tips"))&&1===(0,Fe.Z)(v)&&(localStorage.removeItem("show_login_tips"),re.Rt.info("Tips","Please login to access account")),v&&2===(0,Fe.Z)(v)&&(localStorage.removeItem("show_login_tips"),re.Rt.info("Tips","Please login to access account and complete registration"))}catch(m){console.log("init map layer error:"+JSON.stringify(m))}case 34:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,n=this.state,s=(n.pins,n.searchText),r=n.drawing,i=n.satelliteMode,t=n.showMapLegend,l=n.has2Address,o=this.props,a=o.utilsData,c=o.active,d=(o.editMode,o.auth.user),u=!0,h=(0,w.getLoginType)();null!==d&&void 0!==d||(u=!1),a.editMode&&(u=!1),a.changeColor&&(u=!1),a.bindingProperty&&(u=!1),a.drawFinished&&(u=!1),a.showBusinessInfo&&(u=!1),a.connectToMerchantId>0&&(u=!1),t&&(u=!1),1===(0,Fe.Z)(h)&&(u=!1);var m=!1;return a.editMode||null===d||void 0===d||(1!==(0,Fe.Z)(h)||l)&&(m=!0),(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("div",{className:"showcase-map-top-actions",children:(0,V.jsx)("div",{className:"search-actions",children:null!==d&&void 0!==d&&1===(0,Fe.Z)(h)&&l?null:(0,V.jsx)(A.Z,{onSubmit:this.onSubmitSearch,children:(0,V.jsx)(_.Z,{bsSize:"lg",disabled:m,className:"",value:s,onChange:this.onChangeSearchText,placeholder:"Search..."})})})}),u?i?null:r?(0,V.jsx)("i",{title:"End Drawing",onClick:function(n){return e.toggleDrawing(n)},className:"draw-button fa-2x fa-solid fa-arrow-pointer"}):(0,V.jsx)("i",{title:"Pan, Draw, Connect, Addresses boundary and identify area to Send Email",onClick:function(n){return e.toggleDrawing(n)},className:"draw-button fa-2x fa-solid fa-draw-polygon"}):null,u?i?(0,V.jsx)("i",{onClick:function(n){return e.toggleSatelliteMode(n)},className:"satellite-button red-color fa-2x fa-solid fa-globe"}):(0,V.jsx)("i",{onClick:function(n){return e.toggleSatelliteMode(n)},className:"satellite-button fa-2x fa-solid fa-satellite"}):null,u?!t&&(0,V.jsx)(V.Fragment,{children:(0,V.jsx)("i",{className:"mapLegend-button  close-button fa-3x fa fa-question",onClick:function(n){return e.toggleShowMapLegend(n)}})}):null,t&&(0,V.jsxs)("div",{className:"map-legend_content",children:[(0,V.jsx)("i",{className:"mapLegend-button-close  fa fa-3x fa-close",onClick:function(n){return e.toggleShowMapLegend(n)}}),(0,V.jsx)("b",{children:"Address Markers"}),(0,V.jsx)("table",{children:(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{children:" Business "}),(0,V.jsxs)("td",{children:[(0,V.jsx)("img",{alt:this.PropertyMarkerDescriptions[1].description,src:this.PropertyMarkerDescriptions[1].marker,height:20})," \xa0\xa0"]}),(0,V.jsx)("td",{children:" Connected Customer "}),(0,V.jsxs)("td",{children:[(0,V.jsx)("img",{alt:this.PropertyMarkerDescriptions[0].description,src:this.PropertyMarkerDescriptions[0].marker,height:20})," \xa0\xa0"]}),(0,V.jsx)("td",{children:" Unactivated "}),(0,V.jsxs)("td",{children:[(0,V.jsx)("img",{alt:this.PropertyMarkerDescriptions[2].description,src:this.PropertyMarkerDescriptions[2].marker,height:20})," \xa0\xa0"]})]})}),(0,V.jsx)("hr",{}),(0,V.jsxs)("table",{children:[(0,V.jsxs)("tr",{children:[(0,V.jsxs)("td",{children:[(0,V.jsx)("img",{alt:"Manually add clients",src:ce.kM.extra.edit_mode,height:30})," \xa0\xa0"]}),(0,V.jsx)("td",{children:"Manually Add Clients"})]}),(0,V.jsxs)("tr",{children:[(0,V.jsxs)("td",{children:[(0,V.jsx)("img",{alt:"Connect with Clients",src:ce.kM.extra.connect_mode,height:30})," \xa0\xa0"]}),(0,V.jsx)("td",{children:"Connect with Clients"})]})]}),(0,V.jsx)("hr",{}),(0,V.jsx)("b",{children:"Tools Bar"}),(0,V.jsxs)("table",{children:[(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{children:(0,V.jsx)("i",{className:"fa-2x fa-solid fa-draw-polygon"})}),(0,V.jsxs)("td",{children:["Pan, Draw, Connect, Addresses boundary and identify area to Send Email",(0,V.jsx)("hr",{})]})]}),(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{children:(0,V.jsx)("i",{className:"fa-2x fa-solid fa-arrow-pointer"})}),(0,V.jsxs)("td",{children:["Send Email to identified Opt-in Addresses",(0,V.jsx)("hr",{})]})]}),(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{children:(0,V.jsx)("i",{className:"fa-2x fa-solid fa-satellite"})}),(0,V.jsxs)("td",{children:["Satellite Mode",(0,V.jsx)("hr",{})]})]}),(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{children:(0,V.jsx)("i",{className:"fa-2x fa-solid fa-globe"})}),(0,V.jsx)("td",{children:"Map Mode"})]})]})]}),(0,V.jsx)(v.Z,{}),c&&(0,V.jsx)(le,{}),a.changeColor&&(0,V.jsx)(de,{callback:this.changeColorCallack}),a.bindingProperty&&(0,V.jsx)(he,{}),a.drawFinished&&(0,V.jsx)(Ce,{}),a.showBusinessInfo&&(0,V.jsx)(Ie,{}),a.connectToMerchantId>0&&(0,V.jsx)(le,{}),a.showHighRiseInfo&&(0,V.jsx)(Ae,{}),a.showNoDelivery&&(0,V.jsx)(_e,{}),a.showPreference&&(0,V.jsx)(Ee,{}),a.showFlyerUpload&&(0,V.jsx)(Re,{}),a.showImportCustomer&&(0,V.jsx)(Ue,{})]})}}]),s}(i.Component);ze.contextType=N.ZP;var Le=(0,t.connect)((function(e){return{auth:e.auth,registerForm:e.registerForm,active:e.registerForm.active,utilsData:e.utilsData,editMode:e.utilsData.editMode}}),(function(e){return{getAddressByType:function(n){return e((0,k.WE)(n))},loadBusinessAddress:function(){return e((0,k.f1)())},loadConnected:function(n){return e((0,k.Y5)(n))},fetchUsers:function(){return e((0,k.uh)({page:1,pageSize:1e5}))},setPropertyRegistrationForm:function(n){return e((0,L.ZF)(n))},saveBatchProperties:function(n){return e((0,X.ES)(n))},deleteUserAdditionalAddressById:function(n){return e((0,X.F$)(n))},checkBusinessProfile:function(){return e((0,k.Hc)())},getMe:function(n){return e((0,se.jo)(n))}}}))((0,l.EN)(ze)),Ve=function(){return(0,V.jsxs)("div",{className:"full-screen splash-screen isLoading",children:[(0,V.jsx)("h1",{className:"splash-text",style:{marginBottom:"60px"},children:"KloserToYou"}),(0,V.jsx)("img",{className:"splash-image",src:"/assets/img/logo-alphc.png",alt:"logo"}),(0,V.jsx)("h1",{className:"splash-text",children:"INFINITE MARKETING POSSIBILITIES"})]})},Je=function(){var e=(0,l.TH)().pathname,n=(0,i.useState)(""),s=(0,r.Z)(n,2),u=s[0],h=s[1],m=(0,i.useState)(null),p=(0,r.Z)(m,2),g=p[0],x=p[1];(0,i.useEffect)((function(){if("/"===e){h(e);var n=setTimeout((function(){h("_showcase")}),2e3);x(n)}else clearTimeout(g),x(null),h(e)}),[e]);(0,t.useSelector)((function(e){return e.auth.me}));return(0,V.jsx)(d.Z,{children:(0,V.jsxs)(o.Z,{activeTab:u,className:"home-tab-content",children:[(0,V.jsx)(a.Z,{tabId:"_showcase",className:"",children:(0,V.jsx)(c.Z,{children:"_showcase"===u&&(0,V.jsx)(Le,{})})}),(0,V.jsx)(a.Z,{tabId:"/",className:"",children:(0,V.jsx)(Ve,{})})]})})}}}]);
//# sourceMappingURL=9.66ccedf8.chunk.js.map